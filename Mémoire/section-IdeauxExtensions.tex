\section{Idéaux de Carmichael et extensions de corps}

\subsection{Deux résultats}

Donnons nous \[\Q\subset K \subset L\] une tour de corps de nombres, $I\subset \OK$ un idéal de Carmichael de $K$ et $J \subset \OL$ un idéal de Carmichael de $L$. 

\begin{question}
	L'idéal étendu $I\OL$ est-il de Carmichael dans $\OL$ et l'idéal restreint $J\cap\OK$ est-il de Carmichael dans $\OK$ ? 
\end{question}

L'auteur de l'article a déjà répondu à la première partie de la question dans l'exemple 2.6 de l'article, en utilisant le test de Fermat dans les corps quadratiques.

\begin{proposition}\label{premier-ce}
	Il existe des tours de corps de nombres $\Q\subset K \subset L$ et des idéaux de Carmichael $I$ de $K$ pour lesquels l'idéal étendu $I\OL$ qui n'est pas de Carmichael dans $\OL$.
\end{proposition}

\begin{proof}
	L'exemple 2.6 de l'article montre que l'entier de Carmichael $561$ n'est pas de Carmichael dans $\Q(\sqrt{13})$. On a alors l'énoncé en prenant $K = \Q$, $I = 561\OK$ et $L = \Q(\sqrt{13})$.
\end{proof}

L'algorithme de Korselt \ref{test-primalite-korselt} dans les corps quadratiques permet de répondre à la deuxième partie de la question. 

\begin{proposition}\label{deuxieme-ce}
	Il existe des tours de corps de nombres $\Q\subset K \subset L$ et des idéaux de Carmichael $J$ de $L$ pour lesquels l'idéal restreint $J\cap \OK$ n'est pas de Carmichael dans $\OK$.
\end{proposition}

Pour y répondre, l'auteur du présent mémoire a implémenté l'algorithme suivant\footnote{Pour l'implémentation, voir la fonction \texttt{Carmichael\_ideal\_restricted} du fichier \url{https://github.com/kryzar/TER-Carmichael/blob/master/Simulations\%20et\%20resultats/Algorithms.sage}.}. On se donne une liste d'entiers $d$ sans facteurs carrés et pour tout entier rationnel $n$ \emph{qui n'est pas de Carmichael} dans un intervalle donné, on teste si $n$ est de Carmichael dans $K$ avec le critère de Korselt. Plus précisément, on a l'algorithme suivant.

\vspace{1em}
\begin{algorithm}[H]
\caption{trouver un entier rationnel $n$ et un corps quadratique $K$ tels que $n$ ne soit pas de Carmichael dans $K$, avec le critère de Korselt}
\KwIn{$\mathscr{N}$ (liste d'entiers \emph{qui ne sont pas de Carmichael}), $\mathscr{K}$ (liste de corps quadratiques)}
\KwOut{couples $(n, K)$ où $K$ est un corps quadratique de $\mathscr{K}$ et $n$ est est un entier rationnel de $\mathscr{N}$ de Carmichael dans $K$ mais pas dans $\Q$}
\ForEach{$n$ dans $\mathscr{N}$}{
	\ForEach{$K$ dans $\mathscr{K}$}{
		\If{$n$ est de Carmichael dans $K$ (critère de Korselt)}{
			\KwRet{$n$ de Carmichael dans $K$ mais ne l'est pas dans $\Q$}	\\
		}
	}
}
\end{algorithm}
\vspace{1em}

Cette algorithme retourne de nombreux résultats\footnote{Les résultats se trouvent tous dans l'unique fichier \url{https://github.com/kryzar/TER-Carmichael/blob/master/Simulations\%20et\%20resultats/Carmichael\_ideal\_restricted\_1.txt}. Chaque couple $(d, n)$ vérifie que l'entier rationnel $n$ n'est pas de Carmichael dans $\Q$ mais l'est dans le corps quadratique $Q(\sqrt{d})$.}. Par exemple $35$ est de Carmichael dans $\Q(\sqrt{11})$ et $8029$ est de Carmichael dans $\Q(\sqrt{-73})$ ~; aucun de ces deux nombres n'est de Carmichael dans $\Q$. Nous avons tiré les statistiques suivantes.

\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|}
			\hline
			donnée évaluée & statistique \\
			\hline
			\hline
			nombre de couples testés & 5723 \\\hline
			nombre d'entiers qui sont de Carmichael dans un corps testé & 2930 \\\hline
			proportion d'entiers qui sont de Carmichael dans un corps testé & 51,2 \% \\\hline
		\end{tabular}
		\caption{Statistiques des expérimentations du critère de Korselt sur les corps quadratiques pour les paramètres \ref{param-korselt-quadra}.}
	\end{center}
\end{table}

Face à la généralité de l'énoncé de la question posée, il était tentant d'aller chercher une réponse ou bien théorique, ou bien dans des corps de nombres beaucoup plus compliqués. En fin de compte, les corps quadratiques auront suffit. Nous avons vu à la section précédente que sur les entiers de Carmichael et les corps quadratiques testés, ceux-ci restaient de Carmichael dans environ 24 \% des cas. Ici, nous avons montré que sur les entiers n'étant pas de Carmichael et les corps quadratiques testés, ceux-ci engendraient un entier de Carmichael dans plus de 50 \% des cas. Ces statistiques sont symptomatiques du fait que nous sommes a priori largement ignorants sur le comportement d'un idéal de Carmichael lorsqu'on l'étend ou le restreint, et ce même en restant dans le cadre des corps quadratiques, corps de nombres a priori parmi les moins compliqués.

\subsection{Un peu d'arithmétique}

Voyons maintenant un autre procédé permettant d'expliciter des entiers qui sont de Carmichael dans certains corps quadratiques et non dans $\Q$. L'entier $n = 8029$ exposé précédemment a la particularité d'être le produit de trois nombres premiers distincts\footnote{Nous avons exhibé de nombreux autres entiers $n$ produits de trois nombres premiers distincts qui sont de Carmichael dans certain corps quadratique de la forme $\Q(\sqrt{d})$, où $d$ est sans facteurs carrés, mais ne le sont pas dans $\Q$. La liste de tous les tels couples $(d, n)$ exhibés est disponible ici : \url{https://github.com/kryzar/TER-Carmichael/blob/master/Simulations\%20et\%20resultats/Carmichael\_ideal\_restricted\_2.txt}.} : \[n = 8029 = 7 \cdot 31 \cdot 37,\] d'être de Carmichael dans le corps quadratique $\Q(\sqrt{-73})$) et de ne pas l'être dans $\Q$, et ses facteurs premiers vérifient les hypothèses faites dans l'énoncé suivant.

\begin{proposition}\label{pqr-arithmetique}
	Soient $(p_i)_{1\leq i \leq r}$ une famille de nombres premiers tous impairs et $d$ un entier rationnel sans facteurs carrés. Notons $n$ le produit $n=p_1\cdots p_r$ et supposons que les assertions suivantes sont vérifiées.
	\begin{enumerate}
		\item l'entier $d$ est un carré modulo $p_i$ pour tout indice $1\leq i \leq r$ ~; \label{pqr-a}
		\item l'entier $n^2-1$ est divisible par $p_i - 1$ pour tout indice $1\leq i \leq r$ ~; \label{pqr-b}
		\item au moins l'un des entiers $p_i - 1$, $1\leq i \leq r$, ne divise pas $n-1$. \label{pqr-c}
	\end{enumerate}
Alors, l'entier $n$ est de Carmichael dans $\Q(\sqrt{d})$ mais ne l'est pas dans $\Q$.
\end{proposition}

\begin{proof}
	Posons $K=\Q(\sqrt{d})$. L'hypothèse \ref{pqr-a} implique que $n\OK$ est sans facteurs carrés et que les $p_i$ sont décomposés dans $K$ pour tout indice $1\leq i \leq r$. Fixons $1\leq l \leq r$ un tel indice. Il existe alors deux idéaux premiers distincts $\p_l$ et $\p_l'$ de $\OK$ tels que \[p_l\OK = \p_l\p_l'.\] Soit $\P$ un idéal premier de $\OK$ divisant $n$. Supposons sans perdre de généralité que $\P = \p_l$. On a alors \[\Norm(\P) - 1 = \Norm(\p_l) - 1 = p_l - 1\mid n^2 - 1 = \Norm(n\OK) - 1,\] d'après l'hypothèse \ref{pqr-b}. Le critère de Korselt généralisé \ref{korselt-generalise} et la caractérisation \ref{carac-korselt} impliquent alors que $n$ est de Carmichael dans $K$. Le critère de Korselt \ref{korselt} et l'hypothèse \ref{pqr-c} impliquent que $n$ n'est pas de Carmichael dans $\Q$, d'où le résultat.
\end{proof}

\begin{remarque}\label{pqr-ContreExemple}
	Cet énoncé n'est pas une équivalence. Dans le cas $r=3$, l'entier rationnel $n=665 = 5\cdot 7 \cdot 19$ est de Carmichael dans $\Q(\sqrt{-97})$ mais ne l'est pas dans $\Q$. Cependant, l'entier $d = -97$ n'est jamais un carré modulo un diviseur premier de $n$ et l'entier $n$ ne vérifie pas le point \ref{pqr-b}. Il vérifie toutefois les points \ref{pqr-a} et \ref{pqr-c}.
\end{remarque}

Pour trouver des entiers $(d, n)$ où $d$ est un entier sans facteurs carrés et $n$ est un entier qui est de Carmichael dans $\Q(\sqrt{d})$ mais pas dans $\Q$, nous aurions donc pu utiliser l'algorithme suivant.

\vspace{1em}
\begin{algorithm}[H]
\caption{trouver un entier rationnel $n$ et un corps quadratique $K$ tels que $n$ ne soit pas de Carmichael dans $K$, avec la proposition \ref{pqr-arithmetique}}
\KwIn{$\mathscr{P}$ (liste de nombres premiers impairs), $\mathscr{D}$ (liste d'entiers sans facteurs carrés)}
\KwOut{des couples $((p, q, r), d)$ vérifiant les hypothèses de la proposition \ref{pqr-arithmetique}}
\ForEach{$d$ dans $\mathscr{D}$}{
	\ForEach{$(p, q, r)$ dans $\mathscr{P}^3$, où $p$, $q$ et $r$ sont distincts}{
		$n \leftarrow pqr$ \\
		\If{$d$ est un carré modulo $p$, $q$ et $r$ \normalfont{\textbf{et}} $n^2-1$ est divisible par $p-1$, $q-1$ et $r-1$ \normalfont{\textbf{et}} $p-1$, $q-1$ ou $r-1$ ne divise pas $n-1$}{
			\KwRet{$n$ n'est de Carmichael dans $\Q(\sqrt{d})$, ne l'est pas dans $q$ et est le produit de trois nombres premiers distincts} \\
		}
	}
}
\end{algorithm}
\vspace{1em}

La remarque \ref{pqr-ContreExemple} prouve toutefois que les couples $(d, n)$ exhibés avec cet algorithme jouissent de propriétés arithmétiques beaucoup plus fortes que les couples $(d, n)$ exhibés en toute généralité dans la sous-section précédente.
