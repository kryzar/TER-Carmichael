% main.tex
% Antoine Hugounet

\documentclass[a4paper, 12pt, oneside]{article}
\usepackage{LoLaTeXpackage}
\usepackage{csquotes}
\usepackage{biblatex}
\usepackage[tworuled, onelanguage, french]{algorithm2e}


\addbibresource{bi.bib}
\begin{document}

% début page de titre
\begin{titlepage}
\begin{center}
	\large Antoine Hugounet \\

	\vspace{40px}
	\LARGE \NTS{placeholder Titre}

	\vspace{40px}
	\large
	travail encadré de recherche \\
	encadré par Alain Kraus\footnote{\url{https://webusers.imj-prg.fr/~alain.kraus/}} (IMJ-PRG) \\
	de janvier à juin 2020 \\

	\vspace{20px}
	Sorbonne Université
\end{center}

\normalsize
\vspace{80px}
\begin{center} \textbf{Trop Long ; Pas Lu} \end{center}
\vspace{-1em}
\NTS{placeholder}

\vfill
\begin{center}
	\normalsize \textbf{Mots-clés} : \textit{\NTS{placeholder}}
\end{center}
\end{titlepage}
%% fin page de titre

\section{Un nombre de Carmichael dans un anneau d'entiers ne l'est pas forcément dans un anneau plus petit}

Soient $\Q \subset K \subset L$ une tour de corps de nombres et $n\in \mathbb{Z}$ un entier. Si $n$ est de Carmichael dans $\OL$, l'est-il dans $\OK$ ? Nous affirmons que cette assertion est fausse en exhibant un contre exemple à l'aide du critère de Korselt généralisé (\cite{article}, théorème 2.2). Ce critère impose une condition sur les facteurs de $n\OK$ ($n\OK$ doit être sans facteurs carrés) et une condition sur les normes des diviseurs premiers de $n\OK$ ($\Norm(\p)$ doit diviser $\Norm(n\OK)$ pour tout idéal premier de $\OL$ divisant $n\OK$). L'enjeu est de comprendre si ces propriétés vraies dans $\OL$ sont transmises à $n\OK$.

\begin{remarque}Si $n$ est premier, il peut très bien être de Carmichael dans un anneau d'entiers, mais ne le sera jamais dans l'anneau $\Z$, car un nombre de Carmichael est composé. Nous pouvons donc supposer $n$ composé. \end{remarque}

\subsection{Étude des facteurs carrés}

\begin{lemme}Soient $A$ un anneau commutatif, $B$ une $A$-algèbre commutative et $I$, $J$ deux idéaux de $A$. Alors $$(IJ) B = (IB)(JB).$$
\end{lemme}

\begin{proof}
	Par double inclusion. L'inclusion $$(IJ)B \subset (IB)(JB)$$ est triviale, car $(IB)(JB)$ est un idéal contenant $IB$. Réciproquement, $(IB)(JB)$ est l'idéal de $B$ engendré par les produits $\alpha\beta$, où $\alpha \in IB$ et $\beta\in JB$. Montrons qu'un tel générateur $\alpha\beta$ est forcément dans $(IJ)B$. Nous savons que $\alpha$ et $\beta$ sont de la forme suivante :
	$$\begin{cases}
		\displaystyle \alpha = \sum_{i=1}^n x_i a_i, \quad x_i\in B, a_i \in I \\
		\displaystyle\beta = \sum_{j=1}^m y_j b_j, \quad y_j\in B, b_j \in J.
	\end{cases}$$
	Quitte à rajouter des termes nuls dans l'une des deux sommes, nous pouvons supposer $m=n$. Cela permet d'écrire le produit $$\alpha\beta = \sum_{i,j=1}^n (x_iy_j) (a_i b_j).$$ Pour tout couple $(i, j) \in [\![ 1, n]\!] ^2$, $x_iy_j \in B$, $a_i b_j\in IJ$, d'où $$(x_i y_j)(a_i b_j) \in (IB)J.$$ La somme de ces éléments reste dans $(IB)J$ et donc $\alpha \beta \in (IJ)B$, d'où l'inclusion $$(IB)(JB) \subset (IJ)B,$$ et le résultat désiré.
\end{proof}

Nous en déduisons le très utile résultat suivant.

\begin{lemme}Soient $A$ un anneau de Dedekind, $B$ une $A$-algèbre qui soit elle aussi un anneau de Dedekind, $I$ un idéal de $A$ et $n\in \N^*$ un entier. Si $IB$ n'est pas divisé par un idéal premier à la puissance $n$, alors $I$ non plus.
\end{lemme}

\begin{proof}
Supposons par l'absurde que $\p$ est un idéal premier de $A$ et que $\p^n$ divise $I$, autrement dit que I d'écrit $$I = \p^n J$$ pour un certain idéal $J$ de $A$. D'après le résultat précédent, on peut écrire $$IB = (\p B)^n J.$$ Soit $\P$ un idéal premier de $B$ au dessus de $\p$. On constate alors que $\P^n$ divise $IB$, contradiction. Il n'existe donc aucun idéal premier $\p$ de $A$ tel que $\p^n$ divise $I$.
\end{proof}

\begin{corollaire}Soient $n\in \Z$ un entier et $\Q\subset K\subset L$ une tour de corps de nombres. Si $n\OL$ est sans facteurs carrés, alors $n\OK$ l'est également.
\end{corollaire}

\begin{proof}Il suffit d'appliquer le fait précédent avec $A=\OK$, $B=\OL$ et $I = n\OK$.
\end{proof}

En reprenant les notations du préambule, si $n\OL$ est de Carmichael dans $\OL$, il est sans facteurs carrés. Le corollaire précédent assure que $n\OK$ sera aussi sans facteurs carrés et il nous faut donc étudier la norme pour conclure.

\subsection{Protoétude de la norme}

Reprenons les notations du préambule et supposons que $n$ est de Carmichael dans $\OL$. On a en particulier $$\Norm_\OL(\P) - 1 \mid \Norm_\OK(n\OL) - 1$$ pour tout idéal premier $\P\in \Spec(\OL)$ divisant $n\OK$. Écrivons $$n\OL = \p_1\cdots \p_r$$ la factorisation de $n$ en produit d'idéaux premiers de $\OK$ distincts ($n\OK$ est sans facteurs carrés d'après la sous-section précédente). Pour tout $i\in [\![1, r]\!]$ on voudrait $\Norm_\OK(\pi) - 1\mid \Norm_\OK(n) - 1$. On a bien\footnote{Si $[K : \Q]\mid [L:\Q]$ on a même $\Norm_\OK(n\OK) - 1\mid \Norm_\OL(n\OL) - 1$. C'est trivialement le cas lorsque l'on considère $K=\Q$ mais cela ne change rien.} $$\Norm_\OK(n\OK) = n^{[K : \Q]} \mid \Norm_\OL(n\OL) = n^{[L : \Q]}$$ et $$\Norm_\OL(\p_i \OL) \mid \Norm_\OL(\P)$$ pour tout idéal premier $\P$ de $\OL$ au dessus de $\p_i$, mais il ne semble pas évident de recoller les morceaux pour avoir les divisions désirées. C'est ce constat qui nous amène à chercher un contre exemple.


\subsection{Synthèse et contre-exemple}

Après avoir cherché sans succès un contre-exemple « malin », nous décidons d'écrire un algorithme naïf pour chercher ledit contre-exemple dans des corps quadratiques. L'idée est simple : passer en revue une liste d'entiers $d$ sans facteur carré qui engendrent ces corps et pour chaque tel $d$, tester parmi une liste arbitraire d'entiers naturels, lesquels engendrent un idéal de Carmichael sans être un nombre de Carmichael. \\

Il est facile avec un outil de calcul formel de déterminer si un entier $n$ est de Carmichael dans un corps quadratique $\Q(\sqrt{d})$, $d$ étant sans facteurs carrés. Posons $K=\Q(\sqrt{d})$ et $\mathfrak{n} = \OK$. Le logiciel SageMath\footnote{Voir \url{https://www.sagemath.org} et plus particulièrement \url{http://doc.sagemath.org/html/en/reference/number_fields/sage/rings/number_field/number_field.html}.} est capable de donner la décomposition de $\mathfrak{n}$ en produit d'idéaux premiers de $\mathcal{O}_K$ et calculer des normes d'idéaux. Pour tester si $\mathfrak{n}$ est de Carmichael, on demande à SageMath sa décomposition, on regarde s'il est sans facteurs carrés et si c'est le cas on teste si $\Norm_\OK(\p) - 1$ divise $\Norm_\OK(\mathfrak{n}) - 1$ pour tout idéal premier $\p$ de $\OK$ divisant $\mathfrak{n}$. Comme l'extension considérée est quadratique, $\mathfrak{n}$ a au plus deux facteurs premiers. La norme $\Norm_\OK(\mathfrak{n})$ est quant à elle donnée par $n^2$. \\

Il reste à déterminer si $n$ est un entier de Carmichael. Comme nous n'allons pas chercher bien loin\footnote{Nous nous sommes limités à $d\in [\![-100, 100]\!]$ et $n\in [\![2, 10000]\!]$.} — plutôt que d'effectuer des calculs couteux et inutiles avec le critère de Korselt — il est préférable de regarder si $n$ est dans la (maigre) liste des entiers de Carmichael\footnote{La liste complète des entiers de Carmichael, à l'exception d'une infinité d'entre eux, est disponible ici : \url{https://oeis.org/A002997}.} inférieurs à $10000$ : $$\{561, 1105, 1729, 2465, 2821, 6601, 8911\}.$$ Pour l'implémentation, nous écrivons séparément une fonction testant si $\mathfrak{n}$ est de Carmichael et l'invoquons pour tout couple $(d, n)$. L'algorithme est donc le suivant ; son implémentation est disponible sur GitHub (\url{https://github.com/kryzar/TER-Carmichael/blob/master/Script/Script.sage}).

\vspace{1em}
\begin{algorithm}[H]
\KwIn{a, b, c}
\ForEach{$d\in [\![a, b]\!]$ et $d$ est sans facteur carré}{
	$K = \Q(\sqrt{d})$ \; 
	\ForEach{$n \in [\![2, c]\!]$}{
		\If{$n$ n'est pas de Carmichael \textnormal{\textbf{et}} $n\OK$ est un idéal de Carmichael}{
			exporter $(d, n)$ dans un fichier texte	\;
		}
	}
}
\end{algorithm}
\vspace{1em}

Nous avons pu exhiber de nombreux contre-exemples, comme le couple $$(d, n) = (11, 35).$$ L'entier $35$ n'est pas de Carmichael, mais il engendre un idéal de Carmichael dans $\Q(\sqrt{11})$. Le couple $$(d, n) = (95,8029)$$ est un autre contre-exemple, avec la particularité que $8029 = 7\cdot 31\cdot 37$ est le produit de trois nombres premiers (on rappelle qu'un nombre de Carmichael a au moins trois facteurs premiers). De même, $8029$ n'est pas un entier de Carmichael, mais il engendre un idéal de Carmichael dans $\Q(\sqrt{95})$.

\section*{Addenda}

\begin{fait*}
Soient $n$ un entier qui soit une puissance non triviale d'un nombre premier et $ K$ un corps de nombres. Alors $n\OK$ n'est pas un idéal premier.
\end{fait*}

\begin{proof}
Écrivons $n = p^r, r>1$ et supposons que $n\OK$ soit un idéal premier $\p$ de $\OK$. Alors $\Norm_K(n\OK)$ est une puissance de la caractéristique $\Car(\OK/\p)$, disons $$\Norm_K(n\OK) = \Car(\OK/\p)^f,$$ où $f \leq [K : \Q]$. Mais on a aussi que $$\Norm_K(n\OK) = \Norm_K(n) = (p^r)^{[K : \Q]}.$$ La caractéristique $\Car(\OK/\p)$ étant un nombre premier, il vient $p^f = p^{r[K : \Q]}$. Comme par ailleurs $$f \leq [K : \Q] < r[K : \Q],$$ l'égalité est impossible et nous avons une contradiction. $n\OK$ n'est donc pas un idéal premier.
\end{proof}

\begin{fait*}
	Soient $\Q\subset K \subset L$ une tour de corps de nombres et $I$ un idéal non trivial de $\OL$. Si l'idéal restreint $I\cap \OK$ est non trivial, alors $$\Norm_{\OK}(I \cap \OK) \mid \Norm_{\OL}(I).$$
\end{fait*}

\begin{proof}
C'est un résultat de théorie des groupes à peine déguisé. On a une suite de morphismes de groupes $$\OK\to \OL \to \OL/I.$$ En appelant $f$ la composée des deux flèches, on obtient $\Ker f = I\cap \OK$ et l'on en déduit l'existence d'un morphisme de groupes injectif $$\OK/I\cap \OK \hookrightarrow \OL/I.$$ Ainsi, $\OK/ I\cap \OK$ s'identifie à un sous-groupe de $\OL/I$. D'après le théorème de Lagrange, son cardinal divise donc celui de $\OL/I$. Or, comme nos idéaux sont non triviaux, nous pouvons en prendre les normes, qui sont exactement les cardinaux de ces quotients, par définition. D'où le résultat.
\end{proof}

\begin{fait*} Soient $K$ un corps de nombres et $\P$ un idéal premier de son anneau d'entiers. Alors $$\P\cap \Z = \Car(\OK/\P)\Z.$$
\end{fait*}

\begin{proof}
	D'après, $\Norm_{\Q/\Q}(\P\cap\Z)\mid \Norm_{K/\Q}(\P)$. Or, $\N_{K/\Q}(\P)$ est la puissance d'un nombre premier et ce nombre premier n'est autre que la caractéristique du \textit{corps} $\OK/\P$. Or $\P\cap \Z$ est un idéal premier de $\Z$ et $\Z$ étant principal, $\P\cap \Z$ est engendré par un nombre premier $p\in \Z$. Ainsi, $$\Norm_{\Q/\Q}(\P\cap \Z) = |\Z/p\Z| = p,$$ et donc $$p\mid \Car(O_K/\P).$$ Comme ces deux nombres sont premiers, on a $p = \Car(O_K/\P)$.
\end{proof}

\nocite{*}
\printbibliography
\end{document}
