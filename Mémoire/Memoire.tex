% main.tex
% Antoine Hugounet

\documentclass[a4paper, 12pt, oneside]{article}
\usepackage{LoLaTeXpackage}
\usepackage{csquotes}
\usepackage{biblatex}
\usepackage[tworuled, onelanguage, french]{algorithm2e}
\usepackage[french]{babel}

\renewcommand{\thetheoremcounter}{\arabic{theoremcounter}}

\addbibresource{bi.bib}
\begin{document}

% début page de titre
\begin{titlepage}
\begin{center}
	\large Antoine Hugounet \\

	\vspace{40px}
	\LARGE \NTS{placeholder Titre}

	\vspace{40px}
	\large
	travail encadré de recherche \\
	encadré par Alain Kraus\footnote{\url{https://webusers.imj-prg.fr/~alain.kraus/}} (IMJ-PRG) \\
	de janvier à juin 2020 \\

	\vspace{20px}
	Sorbonne Université
\end{center}

\end{titlepage}
%% fin page de titre

\section*{Introduction}

\begin{question}\label{question-centrale}Soient $n$ un entier de Carmichael et $K$ un corps de nombre. Dans quel mesure $n$ est-il de Carmichael dans $K$ ?
\end{question}

\begin{equation}\label{eq-Carmichael}
\alpha^{\Norm(I)} \equiv \alpha \pmod{I}, \quad \forall \alpha \in \OK.
\end{equation}

\section{Délices de la théorie}

Fort heureusement, certaines propriétés fondamentales des \emph{entiers} de Carmichael sont transportées au cadre plus général des \emph{idéaux} de Carmichael. Tout d'abord, dans une extension \emph{galoisienne}, un idéal premier est soit premier, soit de Carmichael. Plus formellement, vient ceci.
\begin{theoreme}[2.3 dans l'article]
	Soient $p$ un nombre premier et $K$ un corps de nombre abélien tel que $p\nmid \Disc(K)$. Alors, pour tout entier algébrique $\alpha \in \OK$, on a $$\alpha^{\Norm_{K/\Q}(p)} \equiv \alpha \pmod{p\OK}.$$
\end{theoreme}

Vu autrement, on retrouve le petit théorème de Fermat dans les extensions finies abéliennes de $\Q$. Fait tout à fait remarquable, G. A. Steele fournit — dans ce nouveau cadre des idéaux de Carmichael — une réciproque au petit théorème de Fermat.

\begin{theoreme}[2.3 dans l'article]
	Soit $n>2$ un entier composé. Alors il existe un corps \emph{quadratique} $K$ vérifiant $n\nmid \Disc(K)$ et un entier algébrique $\alpha \in \OK$ tels que $$\alpha^{\Norm_{K/\Q}(n)} \not\equiv \alpha \pmod{n\OK}.$$
\end{theoreme}

Ainsi, vient l'équivalence suivante.

\begin{theoreme}[petit théorème de Fermat généralisé et sa réciproque]
	Soit $n>2$ un entier. Alors $n$ est premier \ssi pour tout corps \emph{quadratique} $K$ vérifiant $n\nmid \Disc(K)$ et tout entier algébrique $\alpha \in \OK$, on a $$\alpha^{\Norm_{K/\Q}(n)} \equiv \alpha \pmod{n\OK}.$$
\end{theoreme}

Au delà de sa force théorique, cette énoncé semble porter une valeur historique majeure. Le test de Fermat était le seul à ne pas disposer d'une réciproque (pour le test d'Euler par exemple, c'est une équivalence). Il aura certes fallu la chercher dans les corps de nombres, mais les corps quadratiques suffisent. Ces objets ne sont d'ailleurs pas si loin de l'arithmétique classique : Gauss les étudiait déjà. Quant à la preuve, elle repose — comme la plupart des énoncés de la section 2 de l'article — sur des outils classiques de théorie algébrique des nombres. Son apparente complexité technique raisonnable dissimule un réel savoir-faire. Il semble indispensable de louer la créativité de l'auteur pour l'élaboration de son formalisme, ainsi que la conception de ses preuves. \\

Un autre résultat d'importance (démontré avant le petit théorème de Fermat généralisé dans l'article) est la généralisation du critère de Korselt. C'est ce résultat que l'on utilise en premier lieu pour déterminer si un entier est de Carmichael.

\begin{theoreme}[critère de Korselt généralisé, 2.2 dans l'article]
	Soient $K$ un corps de nombres et $I$ un idéal de $\OK$. On prend garde à supposer que $I$ est composé. Alors $I$ est de Carmichael \ssi $I$ est sans facteurs carrés et pour tout idéal premier $\P$ divisant $I$, on a $$\Norm(\P) - 1 \mid \Norm(I) - 1.$$
\end{theoreme}

\begin{remarque}
	Il faut ici se montrer vigilant avec la nomenclature. Un idéal $I$ est de Carmichael dans un corps de nombres $K$ si $I$ est un idéal \textbf{composé} qui en plus de cela, vérifie l'identité \ref{eq-Carmichael}. Si l'on a un corps de nombres $L$ et un idéal $J$ de $\OK$, montrer que $\Norm(\P) - 1\mid \Norm(J) - 1,\; \forall \P\in \Spec(\OK) : \P\mid J$ ne suffit pas. La preuve du critère de Korselt généralisé nous enseigne que si $J$ est premier, $J$ vérifie également cette identité. Il faut donc indépendamment montrer que $J$ est composé, là est le cœur du problème. L'auteur de l'article fait lui-même une petite erreur en oubliant cette hypothèse dans l'énoncé du théorème 2.7 : il doit y supposer $n$ composé.
\end{remarque}

Le début de cette théorie étant très encourageant, nous partons la développer dans le cadre d'objets parmi les plus usuels de la théorie des nombres : les corps quadratiques.

\section{Troublants corps quadratiques}

\section{Salutaires corps cyclotomiques}

\subsection{Horizon}

L'étude des idéaux de Carmichael dans les corps cyclotomiques est porteuse d'espoir et fournit de beaux résultats susceptibles d'être à la base de tests de primalité, notamment le théorème 3.6. Commençons par un résultat théorique.

\begin{theoreme}[3.1 dans l'article]
	Pour tout entier naturel $n$ composé, il existe une infinité de corps de nombres \emph{abéliens} $K$ de discriminant premier avec $n$ dans lesquels $n$ \emph{n'est pas de Carmichael}.
\end{theoreme}

Un nombre de Carmichael étant composé, il vérifie les hypothèses du théorème. Cela fournit une nouvelle réciproque au petit théorème de Fermat, plus contraignante que la précédente.

\begin{theoreme}[deuxième réciproque]
	Soit $n$ un entier. Alors $n$ est premier \ssi pour tout corps de nombres \emph{abélien} $K$ de discriminant premier avec $n$ et tout entier algébrique $\alpha \in \OK$, on a $$\alpha^{\Norm_{K/\Q}(n\OK)} \equiv \alpha \pmod{n\OK}.$$
\end{theoreme}

Le résultat le plus à même d'aboutir à un test de primalité est le théorème suivant.

\begin{theoreme}[3.6 dans l'article]
	Soit $n$ un entier composé ayant au moins trois facteurs premiers distincts. Alors il existe une infinité de corps cyclotomiques $K$ de la forme $K = \Q(\zeta_q)$, $q$ étant premier, tels que $\Disc(K)$ est premier avec $n$ et $n$ \emph{n'est pas de Carmichael dans $K$}.
\end{theoreme}

Un nombre de Carmichael ayant toujours au moins trois diviseurs premiers distincts, il est aisé d'aboutir à ce corollaire.

\begin{corollaire}[3.7 dans l'article]\label{corollaire-3.7}
	Soit $n$ un entier composé. Il existe au moins un corps cyclotomique de la forme $\Q(\zeta_q)$, $q$ étant premier, de discriminant premier avec $n$ dans lequel $n$ n'est pas de Carmichael.
\end{corollaire}

Ce corollaire a bien entendu droit à sa réciproque du théorème de Fermat.

\begin{theoreme}[troisième réciproque]
	Soit $n$ un entier. Alors $n$ est premier \ssi pour tout corps cyclotomique $K$ de la forme $K = \Q(\zeta_q)$, $q$ étant premier, et tout entier algébrique $\alpha\in \OK$, on a $$\alpha^{\Norm_{K/\Q}(n\OK)} \equiv \alpha \pmod{n\OK}.$$
\end{theoreme}

\subsection{Pratique}

Armé du corollaire \ref{corollaire-3.7}, l'auteur a pu implémenter un algorithme SageMath apportant dans certains cas une réponse à la question centrale de l'article (\ref{question-centrale}). Ici, nous nous donnons des nombres de Carmichael $n$ et cherchons des corps cyclotomiques $K$ de la forme $K = \Q(\zeta_q)$, $q$ étant premier, dans lesquels $n$ \emph{n'est pas de Carmichael}. Nous étudions tous les nombres de Carmichael de la liste\footnote{La liste des premiers entiers de Carmichael est disponible à \url{https://oeis.org/A002997}.} 
\begin{align*}
	\mathfrak{C} = \{& 561, 1105, 1729, 2465, 2821, 6601, 8911, 10585, 15841, 29341, 41041,\\ 
	& 46657, 52633, 62745, 63973, 75361, 101101, 115921, 126217, 162401, \\ 
	& 172081, 188461, 252601, 278545, 294409, 314821, 334153, 340561, \\
	& 399001, 410041, 449065, 488881, 512461\}
\end{align*}
avec l'algorithme suivant.

\vspace{1em}
\begin{algorithm}[H]
\KwIn{borne\_q}
\ForEach{$n$ dans liste\_entiers\_Carmichael}{
	\ForEach{$q$ nombre premier dans $[\![3, \mathrm{borne\_q}]\!]$}{
		$K = \Q(\zeta_q)$ \;
		\If{$\pgcd(q, n) = 1$}{
			\If{$n$ n'est pas de Carmichael dans $K$}{
				exporter le couple $(n, q)$ dans un fichier texte \;
			}
		}
	}
}
\end{algorithm}
\vspace{1em}

\begin{remarque}
	Pour tester si un nombre est de Carmichael dans un corps de nombres de donné, nous implémentons le critère de Korselt dans une fonction dédiée. Pour plus de détails sur l'implémentation de ces algorithmes, nous invitons le lecteur à se référer à l'annexe \ref{annexe-ce}.
\end{remarque}

Pour chacun des nombres $n$ de la liste $\mathfrak{C}$, cet algorithme a pu exhiber de nombreux corps cyclotomiques dans lesquels $n$ n'est pas de Carmichael, prouvant que $n$ est composé~! Par exemple,
\begin{itemize}
	\item $561$ n'est pas de Carmichael dans $\Q(\zeta_5)$ ; 
	\item $1729$ n'est pas de Carmichael dans $\Q(\zeta_{17})$ ;
	\item $512461$ n'est pas de Carmichael dans $\Q(\zeta_{83})$.
\end{itemize}

Nombre d'autres résultats sont disponibles sur la page GitHub de l'auteur : \url{https://github.com/kryzar/TER-Carmichael/blob/master/Scripts/Results_Corollary_3-7.txt}. \\

Cet algorithme permet aussi de prouver que l'entier de Howe est composé ! Notons $h$ cet entier. Mentionné après le théorème 2.7 de l'article, $h$ vaut $$h = 17 \cdot 31 \cdot 41 \cdot 43 \cdot 89 \cdot 97 \cdot 167 \cdot 331$$ et est de Carmichael non seulement dans $\Q$, mais aussi dans tout corps quadratique dont le discriminant est premier avec $h$ (on dit que $h$ est un nombre de Carmichael \emph{rigide d'ordre 2}). Notre algorithme exhibe toutefois de nombreux corps cyclotomiques dans lesquels $h$ n'est pas de Carmichael, comme $\Q(\zeta_{199})$. La liste complète des résultats trouvés est cette fois disponible à \url{https://github.com/kryzar/TER-Carmichael/blob/master/Scripts/Results_Howe_cyclotomic.txt}.


\subsection{Technique}



\newpage
\begin{appendix}
\section{Produire des contre-exemples}\label{annexe-ce}

Question : soient $\Q \subset K \subset L$ une tour de corps de nombres et $n\in \mathbb{Z}$ un entier, si $n$ est de Carmichael dans $\OL$, l'est-il dans $\OK$ ? Nous affirmons que cette assertion est fausse en exhibant un contre exemple à l'aide du critère de Korselt généralisé (\cite{article}, théorème 2.2). Ce critère impose une condition sur les facteurs de $n\OK$ ($n\OK$ doit être sans facteurs carrés) et une condition sur les normes des diviseurs premiers de $n\OK$ ($\Norm_{K/\Q}(\p)-1$ doit diviser $\Norm_{K/\Q}(n\OK) - 1$ pour tout idéal premier de $\OL$ divisant $n\OK$). L'enjeu est de comprendre si ces propriétés vraies dans $\OL$ sont transmises à $n\OK$.

\begin{remarque}Si $n$ est premier, il peut très bien être de Carmichael dans un anneau d'entiers, mais ne le sera jamais dans l'anneau $\Z$, car un nombre de Carmichael est composé. Nous pouvons donc supposer $n$ composé. \end{remarque}

Se convainquant rapidement que les hypothèses demandées sont trop fortes pour être transmises, nous décidons d'écrire un algorithme naïf pour chercher ledit contre-exemple dans des corps quadratiques. L'idée est simple : passer en revue une liste d'entiers $d$ sans facteur carré qui engendrent ces corps et pour chaque tel $d$, tester parmi une liste arbitraire d'entiers naturels, lesquels engendrent un idéal de Carmichael sans être un nombre de Carmichael. \\

Il est facile avec un outil de calcul formel de déterminer si un entier $n$ est de Carmichael dans un corps quadratique $\Q(\sqrt{d})$, $d$ étant sans facteurs carrés. Posons $K=\Q(\sqrt{d})$ et $I = \OK$. Le logiciel SageMath\footnote{Voir \url{https://www.sagemath.org} et plus particulièrement \url{http://doc.sagemath.org/html/en/reference/number_fields/sage/rings/number_field/number_field.html}.} est capable de donner la décomposition de $I$ en produit d'idéaux premiers de $\mathcal{O}_K$ et calculer des normes d'idéaux. Pour tester si $I$ est de Carmichael, on demande à SageMath sa décomposition, on regarde s'il est sans facteurs carrés et si c'est le cas on teste si $\Norm_{K/\Q}(\p) - 1$ divise $\Norm_{K/\Q}(I) - 1$ pour tout idéal premier $\p$ de $\OK$ divisant $I$. Comme l'extension considérée est quadratique, $I$ a au plus deux facteurs premiers. La norme $\Norm_{K/\Q}(I)$ est quant à elle donnée par $n^2$. \\

Il reste à déterminer si $n$ est un entier de Carmichael. Comme nous n'allons pas chercher bien loin\footnote{Nous nous sommes limités à $d\in [\![-100, 100]\!]$ et $n\in [\![2, 10000]\!]$.} — plutôt que d'effectuer des calculs couteux et inutiles avec le critère de Korselt — il est préférable de regarder si $n$ est dans la (maigre) liste des entiers de Carmichael inférieurs à $10000$ : $$\{561, 1105, 1729, 2465, 2821, 6601, 8911\}.$$ Pour l'implémentation, nous écrivons séparément une fonction testant si $I$ est de Carmichael et l'invoquons pour tout couple $(d, n)$. L'algorithme est donc le suivant ; son implémentation est disponible sur le compte GitHub de l'auteur (\url{https://github.com/kryzar/TER-Carmichael/blob/master/Script/Script.sage}).

\vspace{1em}
\begin{algorithm}[H]
\KwIn{a, b, c}
\ForEach{$d\in [\![a, b]\!]$ et $d$ est sans facteur carré}{
	$K = \Q(\sqrt{d})$ \; 
	\ForEach{$n \in [\![2, c]\!]$}{
		\If{$n$ n'est pas de Carmichael \textnormal{\textbf{et}} $n\OK$ est un idéal de Carmichael}{
			exporter $(d, n)$ dans un fichier texte	\;
		}
	}
}
\end{algorithm}
\vspace{1em}

Nous avons pu exhiber de nombreux contre-exemples, comme le couple $$(d, n) = (11, 35).$$ L'entier $35$ n'est pas de Carmichael, mais il engendre un idéal de Carmichael dans $\Q(\sqrt{11})$. Le couple $$(d, n) = (95,8029)$$ est un autre contre-exemple, avec la particularité que $8029 = 7\cdot 31\cdot 37$ est le produit de trois nombres premiers (on rappelle qu'un nombre de Carmichael a au moins trois facteurs premiers). De même, $8029$ n'est pas un entier de Carmichael, mais il engendre un idéal de Carmichael dans $\Q(\sqrt{95})$.

\end{appendix}

\section{Todo}
\NTS{
\begin{itemize}
	\item Enlever les hypothèses $Disc(K)$ premier avec $n$ si A. Kraus est ok et rajouter en lemme que c'est bon en introduction
	\item Rajouter des liens vers les fonctions implémentées depuis les algorithmes.
\end{itemize}
}

\nocite{*}
\printbibliography
\end{document}
