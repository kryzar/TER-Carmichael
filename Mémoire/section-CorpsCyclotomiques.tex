\section{Corps cyclotomiques}

\subsection{Théorie}

Dans cette section, nous nous intéressons aux corps cyclotomiques de la forme $\Q(\zeta_q)$ où $q$ est un nombre premier. Commençons par un résultat théorique.

\begin{theoreme}[{\cite[th. 3.1]{article}}]\label{theoreme-3.1}
	Pour tout entier naturel $n$ composé, il existe une infinité de corps de nombres \emph{abéliens} de discriminant premier avec $n$ dans lesquels $n$ n'est pas de Carmichael.
\end{theoreme}

\begin{MotSurPreuve}
	Les preuves des énoncés sur les corps cyclotomiques sont autrement plus sophistiquées que celles sur les corps quadratiques et l'auteur y utilise des résultats de théorie analytique des nombres. Ces derniers assurent de l'existence d'objets mais ne les construisent pas, à l'image des lemmes 3.3 et 3.4 de l'article. Pour ce théorème, la construction des corps se fait avec la correspondance de Galois et la vérification qu'ils vérifient les bonnes propriétés nécessite des arguments sophistiqués de ramification (groupes de décomposition et d'inertie, Frobenius d'un élément). Nous verrons ces arguments plus en détails dans la preuve du théorème 3.6 de l'article (n°\ref{theoreme-3.6} chez nous). \\
\end{MotSurPreuve}

Un nombre de Carmichael $n$ étant composé, le théorème \ref{theoreme-3.1} assure qu'il existe une infinité de corps de nombres abéliens de discriminant premier avec $n$ dans lesquels $n$ n'est pas de Carmichael. Cela fournit une nouvelle réciproque au petit théorème de Fermat, plus contraignante que la précédente.

\begin{theoreme}[deuxième réciproque]\label{reciproque-2}
	Soit $n$ un entier rationnel. Alors $n$ est premier \ssi pour tout corps de nombres \emph{abéliens} $K$ de discriminant premier avec $n$, $n$ n'admet aucun $K$-témoin de Fermat.
\end{theoreme}

\begin{proof}
	Supposons que $n$ est premier. Dans ce cas, d'après le théorème \ref{ptf} et la définition \ref{def-K-temoin}, de $K$-témoin de Fermat dans aucun corps de nombres abélien $K$ de discriminant premier avec $n$. L'application réciproque résulte directement du théorème \ref{theoreme-3.1}.
\end{proof}

Le résultat le plus à même d'aboutir à un test de primalité est le crucial théorème suivant. Il nous enseigne qu'il faut aller chercher du côté des corps cyclotomiques. Nous en donnons la démonstration.

\begin{theoreme}[{\cite[th. 3.6]{article}}]\label{theoreme-3.6}
	Soit $n$ un entier rationnel composé ayant au moins trois facteurs premiers distincts. Alors il existe une infinité de corps cyclotomiques $K$ de la forme $K = \Q(\zeta_q)$, $q$ étant premier, tels que $\Disc(K)$ soit premier avec $n$, et que $n$ ne soit pas de Carmichael dans $K$.
\end{theoreme}

Nous avons de quelques résultats préliminaires. Remarquons d'abord que $\Disc(K) = (-1)^{\frac{q-1}{2}} q^{q-2}$.

\begin{lemme}[{\cite[lemme 3.3]{article}}]\label{lemme-3.3}
	Soit $n$ un entier rationnel. Si $n$ n'est pas la puissance d'un nombre premier, alors pour tout diviseur premier $p$ de $n$, il existe un rang $d_0$ tel que la relation \[p^d - 1 \nmid n^d - 1\] soit vérifiée pour tout entier rationnel $d> d_0$.
\end{lemme}

\begin{proof}
	Voir \cite{lemme33}.
\end{proof}

\begin{lemme}[théorème de Heath-Brown, {\cite[th. 3.5]{article}}]\label{heath-brown}
	Tous les nombres premiers, à l'exception d'au plus deux d'entre eux, sont des racines primitives modulo $q$ pour une infinité de nombres premiers $q$.
\end{lemme}

\begin{proof}
	Voir \cite{HeathBrown}.
\end{proof}

\begin{lemme}\label{lemme-inerte}
	Soient $K/\Q$ une extension \emph{abélienne} de degré fini et $p$ un nombre premier non ramifié. S'il existe un groupe \emph{cyclique} $H$ et un isomorphisme de groupes \[\Gal(K/\Q) \to H\] qui envoie la substitution de Frobenius de $p$ en $K/\Q$\footnote{Bien définie dans le cas abélien.} sur un générateur de $H$, alors $p$ est inerte dans $K$.
\end{lemme}

\begin{proof}
	Dans cette preuve, nous utilisons les résultats de \cite[ch. 3 § 4 et 5]{Kraus}. Soient $f : \Gal(K/\Q) \to H$ un isomorphisme de groupes, $s_p$ la substitution de Frobenius de $p$ en $K/\Q$ et $h$ un générateur de $H$ vérifiant $f(s_p) = h$. L'extension étant non ramifiée en $p$, tout ceci a bien un sens. Comme $h$ engendre $H$, que $s_p$ engendre le sous-groupe de décomposition de $p$\footnote{Bien défini dans le cas abélien.} et que $f$ est un isomorphisme entre $\Gal(K/\Q)$ et $H$, le Frobenius $s_p$ est générateur de $\Gal(K/\Q)$. On a donc l'égalité \[D_p = \Gal(K/\Q).\] La sous-extension de $K/\Q$ correspondant $D_p$ dans la correspondance de Galois est donc $\Q$. D'après \cite[lemme 3.9]{Kraus}, cela induit que $p$ n'a qu'un seul idéal premier au-dessus de lui. L'idéal $p$ est donc l'unique idéal premier de $\OK$ au-dessus de $p$, et comme $p$ ne se ramifie pas dans $K$, cela prouve l'inertie que $p$ est inerte dans $K$..

\end{proof}

\begin{lemme}\label{iso-Z/nZ*}
	Soient $n \geq 1$ un entier rationnel et $\zeta_n$ une racine primitive $n$-ième de l'unité. L'application 
\begin{center}
	\begin{tabular}{ccc}
		$\Gal(\Q(\zeta_n)/\Q)$ & $\longrightarrow$ & $\left(\Z/n\Z\right)^\times$ \\
		$\sigma$	& $\longmapsto$ & $\overline{a}$,
	\end{tabular}
\end{center}
où $a$ est un entier rationnel tel que $\sigma(\zeta_n) = \zeta_n^a$, est un isomorphisme de groupes bien défini.
\end{lemme}

\begin{proof}
	Commençons par montrer que cette application est bien définie et que c'est un morphisme de groupes. Notons la $\varphi$. Soit $\sigma\in \Gal(\Q(\zeta_n)/\Q)$. Cet automorphisme envoie $\zeta_n$ sur une autre racine primitive de l'unité. La racine $\zeta_n$ étant primitive,  on a \[\sigma(\zeta_n) = \zeta_n^a\] avec $a$ premier avec $n$. Si désormais $a$ et $b$ sont deux entiers rationnels tels que $\zeta_n^a = \zeta_n^b$, on a alors $\zeta_n^{a-b} = 1$. Comme $\zeta_n$ est primitive, cela implique \[\overline{a} = \overline{b}.\] Enfin, cette application est un morphisme de groupes, soient $\sigma_1, \sigma_2 \in \Gal(\Q(\zeta_n)/\Q)$ dont les images respectives par $\varphi$ sont $a_1$ et $a_2$. On a \[\sigma_1\circ \sigma_2(\zeta_n) = \sigma_1(\zeta_n^{a_2}) = (\sigma_1(\zeta_n))^{a_2} = \zeta^{a_1 a_2}\] et donc \[\varphi(\sigma_1\circ\sigma_2) = a_1 a_2 = \varphi(\sigma_1)\varphi(\sigma_2).\] L'application $\varphi$ est donc un morphisme de groupes bien défini. \\

	Montrons que c'est un isomorphisme. Comme les ensembles de départ et d'arrivée sont finis, il suffit de montrer l'injectivité. Soit $\sigma\in \Gal(\Q(\zeta_n)/\Q)$ un automorphisme d'image $\overline{1}$. On a alors \[\sigma(\zeta_n) = \zeta_n\] et comme $\sigma$ fixe $\Q$, l'égalité \[\sigma = \Id.\] Cela termine la démonstration.
\end{proof}


Démontrons le théorème \ref{theoreme-3.6}.

\begin{proof}[Démonstration (du théorème \ref{theoreme-3.6})]
	L'entier $n$ a par hypothèse au moins trois facteurs premiers distincts. D'après le théorème Heath-Brown \ref{heath-brown}, l'un d'entre eux, que nous notons $p$, est donc racine primitive modulo $q$ pour une infinité de nombres premiers $q$. Soit $d_0$ le rang à partir duquel on a \[p^d - 1 \nmid n^d - 1\] pour tout entier $d>d_0$, donné par le lemme \ref{lemme-3.3}. On en déduit l'existence d'une infinité de nombres premiers $q$ (premiers avec $n$) pour lesquels $p$ est une racine primitive et vérifiant $q>d_0$. Fixons un tel nombre $q$ et \[K = \Q(\zeta_q).\] Soit $\varphi$ l'isomorphisme
\begin{center}
	\begin{tabular}{cccc}
		$\varphi :$ & $\Gal(\Q(\zeta_q)/\Q)$ & $\longrightarrow$ & $\mathbb{F}_q^*$ \\
		&$\sigma$	& $\longmapsto$ & $\overline{a}$,
	\end{tabular}
\end{center}
	où $a$ est un entier rationnel tel que $\sigma(\zeta_q) = \zeta_q^a$, donné par le lemme \ref{iso-Z/nZ*} pour $n=q$. D'après \cite[p. 45 relation (23)]{Kraus}, $\varphi$ envoie le Frobenius de $p$ sur la classe de $p$ modulo $q$. Comme $p$ est une racine primitive modulo $q$, le lemme \ref{lemme-inerte} appliqué à $K/\Q$ et $\varphi$ prouve que $p$ est inerte dans $K$. En particulier, l'idéal $p\OK$ est un idéal premier de $\OK$ divisant $n\OK$. On peut supposer $d_0 > q-1$. On a alors \[ \Norm(p\OK) - 1 = \Norm_{K/Q}(p) - 1 = p^{q-1} - 1 \nmid n^{q-1} - 1 = \Norm_{K/\Q}(n) - 1 = \Norm(n\OK) - 1.\] Le critère de Korselt généralisé \ref{korselt-generalise} et la caractérisation \ref{carac-korselt} permettent d'affirmer que $n$ n'est pas de Carmichael dans $K$, terminant la démonstration.

\end{proof}

Un nombre de Carmichael ayant toujours au moins trois diviseurs premiers distincts (voir \cite[p. 90 prop. 3.35]{Demazure}), il vérifiera toujours les hypothèses du théorème. Ce résultat est donc en théorie bien plus puissant que le théorème \ref{theoreme-2.5} (\cite[th. 2.5]{article}), puisque nous avons vu que le test de primalité naïf qui en découlait ne détectait pas tous les entiers de Carmichael, comme par exemple l'entier de Howe \ref{Howe}. 

\begin{corollaire}[{\cite[cor. 3.7]{article}}]\label{corollaire-3.7}
	Soit $n$ un entier rationnel composé. Il existe au moins un corps cyclotomique de la forme $\Q(\zeta_q)$, $q$ étant premier, de discriminant premier avec $n$ dans lequel $n$ n'est pas de Carmichael.
\end{corollaire}

\begin{proof}
	Distinguons trois cas.
	\begin{itemize}
		\item Si $n$ a un unique facteur premier, étant composé, il a un facteur carré et ne sera jamais de Carmichael, d'après le critère de Korselt généralisé \ref{korselt-generalise}.
		\item Si $n$ a deux uniques facteurs premiers distincts, il n'est pas de Carmichael dans $\Q$, le corps cyclotomique $\Q(\zeta_2)$ (voir \cite{Demazure}, Proposition 3.35, p. 90).
		\item Si $n$ a au moins trois facteurs premiers distincts, nous appliquons le théorème précédent.
	\end{itemize}
\end{proof}

Ce corollaire a bien entendu droit à sa réciproque du théorème de Fermat.

\begin{theoreme}[troisième réciproque]\label{reciproque-3}
	Soit $n$ un entier rationnel. Alors $n$ est premier \ssi pour tout corps cyclotomique $K$ de la forme $K = \Q(\zeta_q)$, où $q$ est un nombre premier ne divisant par $n$, $n$ n'admet aucun $K$-témoin de Fermat.
\end{theoreme}

\begin{remarque}
	L'énoncé est faux si $q$ divise $n$. Sous cette hypothèse, l'entier $q$ se ramifie dans $\Q(\zeta_q)$ et l'idéal $n\OK$ a un facteur carré, ce qui contredit le critère de Korselt \ref{korselt-generalise} et la caractérisation \ref{carac-korselt}.
\end{remarque}

\begin{proof}
	C'est la conjonction du théorème \ref{ptf} et du corollaire \ref{corollaire-3.7}.
\end{proof}

\begin{remarque}
	Dans les deux réciproques (théorèmes \ref{reciproque-2} et \ref{reciproque-3}) que nous venons de donner, l'hypothèse sur le discriminants est que $n$ et $K$ doivent être premiers entre eux. C'est une hypothèse bien plus forte que de demander à ce que $n$ ne divise pas le discriminant de $K$ comme dans les corps quadratiques (\ref{ptf-reciproque})et cela permet de tester beaucoup moins de corps.
\end{remarque}

Passons désormais aux simulations numériques.

\subsection{Simulations numériques}

Comme dans la section sur les corps quadratiques, nous cherchons ici — pour tout entier $n$ de la liste \ref{liste-carmichael} — un corps cyclotomique de la forme $\Q(\zeta_q)$, $q$ étant premier, dans lequel il n'est pas de Carmichael et dont le discriminant est premier avec $n$. Nous reprenons donc l'algorithme \ref{test-primalite-korselt} et l'utilisons avec les paramètres suivants\footnote{Pour l'implémentation, voir la fonction \texttt{Carmichael\_cyclotomic} du fichier \url{https://github.com/kryzar/TER-Carmichael/blob/master/Simulations\%20et\%20resultats/Algorithms.sage}.}.

\begin{table}[H]\label{param-korselt-cyclo}
	\begin{center}
		\begin{tabularx}{\textwidth}{|Y|Y|}
			\hline
			paramètre & valeur \\
			\hline
			\hline
			corps testés & corps cyclotomiques de la forme $\Q(\zeta_q)$ où $q$ est un nombre premier dans $[\![3, 300]\!]$\footnote{Il y a 62 tels nombres premiers.} \\\hline
			entiers de Carmichael testés & tous ceux de la liste \ref{liste-carmichael} \\\hline
		\end{tabularx}
		\caption{Paramètres des simulations du critère de Korselt pour les corps cyclotomiques.}
	\end{center}
\end{table}

Avec ces paramètres, le critère de Korselt a donné pour chaque élément $n$ de la liste, plusieurs corps cyclotomiques de discriminant premier avec $n$ dans lesquels $n$ n'est pas de Carmichael\footnote{Les résultats se trouvent tous dans \url{https://github.com/kryzar/TER-Carmichael/tree/master/Simulations\%20et\%20resultats}, sous la forme d'un fichier par entier testé. Par exemple, les résultats pour l'entier $561$ se trouvent dans le fichier \texttt{561\_cylotomic.txt}.}. Pour l'entier $n = 561$, nous trouvons par exemple qu'il est de Carmichael dans $\Q(\zeta_3)$ mais dans aucun autre corps testé. Cet algorithme permet aussi de prouver que l'entier de Howe \ref{Howe} est composé~! Nous trouvons qu'il est de Carmichael dans $\Q(\zeta_3)$ mais dans aucun autre corps testé\footnote{Nous sommes en réalité allés plus loin pour l'entier de Howe et avons testé tous les corps cyclotomiques de la forme $\Q(\zeta_q)$ où $q$ est un nombre premier compris entre $3$ et $600$.} En fait, nous avons trouvé très peu de couples $(n, K)$ où $n$ est un entier de Carmichael de la liste et $K$ un corps cyclotomique dans lequel $n$ est de Carmichael. La liste exhaustive de tels couples est la suivante.

\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|}
			\hline
			entier de Carmichael & corps cyclotomique dans lequel il est de Carmichael \\
			\hline
			\hline
			561				& $\Q(\zeta_3)$ \\\hline
			2821			& $\Q(\zeta_3)$ \\\hline
			1729			& $\Q(\zeta_3)$ \\\hline
			8911			& $\Q(\zeta_3)$ \\\hline
			15841			& $\Q(\zeta_3)$ \\\hline
			29341			& $\Q(\zeta_3)$ \\\hline
			46657			& $\Q(\zeta_3)$ \\\hline
			52633			& $\Q(\zeta_3)$ \\\hline
			63973			& $\Q(\zeta_3)$ \\\hline
			115921			& $\Q(\zeta_3)$ \\\hline
			126217			& $\Q(\zeta_3)$ \\\hline
			172081			& $\Q(\zeta_3)$ \\\hline
			115921			& $\Q(\zeta_3)$ \\\hline
			188461			& $\Q(\zeta_3)$ \\\hline
			252601			& $\Q(\zeta_5)$ \\\hline
			294409			& $\Q(\zeta_3)$ \\\hline
			488881			& $\Q(\zeta_3)$ \\\hline
			512461			& $\Q(\zeta_3)$ et $\Q(\zeta_5)$ \\\hline
			entier de Howe	& $\Q(\zeta_3)$ \\\hline
		\end{tabular}
	\end{center}
	\caption{Liste exhaustive des couples trouvés $(n, K)$ où $n$ est un entier de Carmichael et $K$ un corps cyclotomique dans lequel $n$ reste de Carmichael.}
\end{table}

Voici les faits remarquables à retenir de ces simulations.
	\begin{itemize}
		\item Nous n'avons trouvé aucun corps cyclotomique parmi ceux testés dans lequel les entiers suivants sont de Carmichael : 561, 1105, 2465, 6601, 1085, 41041, 62745, 101101, 449065.
		\item Les autres entiers sont de Carmichael dans $\Q(\zeta_3)$ ou $\Q(\zeta_5)$, mais dans aucun autre corps testé.
		\item Les deux seuls entiers de Carmichael de la liste de Carmichael dans $\Q(\zeta_5)$ sont 252601 et 512461. Leurs facteurs premiers sont congrus à $1$ modulo $5$. À noter que nous avons exhibé des entiers rationnels qui ne sont pas de Carmichael, dont tous les facteurs premiers ne sont pas congrus à $1$ modulo $5$ et qui sont de Carmichael dans $\Q(\zeta_5)$. C'est par exemple\footnote{Nous avons exhibé de nombreux tels autres entiers, tous donnés dans le fichier \url{https://github.com/kryzar/TER-Carmichael/blob/master/Simulations\%20et\%20resultats/CarmichaelInQzeta5\_NotCarmichaelInt\_PrimeFactorsNot1mod5.txt}.} le cas de $2047$ (qui n'est même pas congru à $1$ modulo $5$).
		\item L'entier 512461 est l'unique testé qui soit de Carmichael dans deux corps cyclotomiques à la fois.
		\item L'entier de Howe est de Carmichael dans $\Q(\zeta_3)$ (qui est égal au corps quadratique $\Q(\sqrt{-3})$) mais dans aucun autre corps testé.
	\end{itemize}

Donnons aussi quelques statistiques.

\begin{table}[H]\label{statistiques-cyclo}
	\begin{center}
		\begin{tabular}{|c|c|}
			\hline
			nombre de corps testés & 1857 \\\hline
			nombre d'idéaux de Carmichael trouvés dans ces corps & 18 \\\hline
			proportion d'idéaux de Carmichael trouvés dans ces corps & 0,9 \% \\\hline
		\end{tabular}
		\caption{Statistiques des simulations du critère de Korselt sur les corps cyclotomiques pour les paramètres \ref{param-korselt-cyclo}.}
	\end{center}
\end{table}

Quant aux performances, les calculs sont cependant significativement plus longs dans le cas des corps cyclotomiques que dans le cas des corps quadratiques. Nous donnons ici le temps nécessaire au critère de Korselt pour déterminer si l'entier $n = 512461$ est de Carmichael dans les corps donnés. On retrouve néanmoins le fait que lesdits temps restent sensiblement proches pour tout entier rationnel (y compris l'entier de Howe) et tout corps cyclotomique testé. 

\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|c|}
			\hline
			corps cyclotomique & $512461$ reste de Carmichael dans ce corps & temps de calcul \\
			\hline
			\hline
			$\Q(\zeta_7)$ & non &0.005 s \\\hline
			$\Q(\zeta_{101})$ & non & 1.626 s \\\hline
			$\Q(\zeta_{199})$ & non & 18.9 s \\\hline
			$\Q(\zeta_{293})$ & non & 38.4 s \\\hline
		\end{tabular}
		\caption{Temps de calcul du critère Korselt dans les corps cyclotomiques donnés pour l'entier $n=512461$.}
	\end{center}
\end{table}
