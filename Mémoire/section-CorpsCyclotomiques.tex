\section{Corps cyclotomiques}

\subsection{Théorie}

Dans cette section, nous nous intéressons aux corps cyclotomiques de la forme $\Q(\zeta_q)$, $q$ étant un nombre premier. Commençons par un résultat théorique.

\begin{theoreme}[3.1 dans l'article]
	Pour tout entier naturel $n$ composé, il existe une infinité de corps de nombres \emph{abéliens} de discriminant premier avec $n$ dans lesquels $n$ \emph{n'est pas de Carmichael}.
\end{theoreme}

\begin{MotSurPreuve}
	Les preuves des énoncés sur les corps cyclotomiques sont autrement plus sophistiquées que celles sur les corps quadratiques et l'auteur y utilise à volonté des résultats de théorie analytique des nombres. Ces derniers assurent de l'existence d'objets mais ne les construisent pas, à l'image des lemmes 3.3 et 3.4 de l'article. Pour ce théorème, la construction des corps se fait avec la correspondance de Galois et la vérification et la vérification qu'ils vérifient les bonnes propriétés nécessite des arguments sophistiqués de ramification (groupes de décomposition et d'inertie, Frobenius d'un élément). Nous verrons ces arguments plus en détails dans la preuve du théorème 3.6 de l'article (n°\ref{theoreme-3.6} chez nous). \\
\end{MotSurPreuve}

Un nombre de Carmichael étant composé, il vérifie les hypothèses du théorème. Cela fournit une nouvelle réciproque au petit théorème de Fermat, plus contraignante que la précédente.

\begin{theoreme}[deuxième réciproque]
	Soit $n$ un entier. Alors $n$ est premier \ssi pour tout corps de nombres \emph{abélien} $K$ de discriminant premier avec $n$ et tout entier algébrique $\alpha \in \OK$, on a $$\alpha^{\Norm_{K/\Q}(n)} \equiv \alpha \pmod{n\OK}.$$
\end{theoreme}

Le résultat le plus à même d'aboutir à un test de primalité est le crucial théorème suivant. Il nous enseigne qu'il faut aller chercher du côté des corps cyclotomiques. Nous en donnons la démonstration.

\begin{theoreme}[3.6 dans l'article]\label{theoreme-3.6}
	Soit $n$ un entier composé ayant au moins trois facteurs premiers distincts. Alors il existe une infinité de corps cyclotomiques $K$ de la forme $K = \Q(\zeta_q)$, $q$ étant premier, tels que $\Disc(K)$ est premier avec $n$ et $n$ \emph{n'est pas de Carmichael dans $K$}.
\end{theoreme}

\begin{proof}
	\NTS{placeholder}
\end{proof}

Un nombre de Carmichael ayant toujours au moins trois diviseurs premiers distincts (voir \cite{Demazure}, Proposition 3.35, p. 90), il vérifiera toujours les hypothèses du théorème. Ce résultat est donc en théorie bien plus puissant que le théorème \ref{theoreme-2.5} (2.5 dans l'article), puisque nous avons vu que le test de primalité naïf qui en découlait ne détectait pas tous les entiers de Carmichael, comme par exemple l'entier de Howe \ref{Howe}. Nous avons par ailleurs le corollaire suivant, qui montre lui aussi la supériorité des corps cyclotomiques pour détecter des corps dans lesquels un entier de Carmichael n'est pas de Carmichael.

\begin{corollaire}[3.7 dans l'article]\label{corollaire-3.7}
	Soit $n$ un entier composé. Il existe au moins un corps cyclotomique de la forme $\Q(\zeta_q)$, $q$ étant premier, de discriminant premier avec $n$ dans lequel $n$ n'est pas de Carmichael.
\end{corollaire}

\begin{proof}
	Distinguons trois cas.
	\begin{itemize}
		\item Si $n$ a un unique facteur premier, étant composé, il a un facteur carré et ne sera jamais de Carmichael, d'après le critère de Korselt généralisé \ref{korselt-generalise}.
		\item Si $n$ a deux uniques facteurs premiers distincts, il n'est pas de Carmichael dans $\Q$, le corps cyclotomique $\Q(\zeta_2)$ (voir \cite{Demazure}, Proposition 3.35, p. 90).
		\item Si $n$ a au moins trois facteurs premiers distincts, nous appliquons le théorème précédent.
	\end{itemize}
\end{proof}

Ce corollaire a bien entendu droit à sa réciproque du théorème de Fermat.

\begin{theoreme}[troisième réciproque]
	Soit $n$ un entier. Alors $n$ est premier \ssi pour tout corps cyclotomique $K$ de la forme $K = \Q(\zeta_q)$, $q$ étant premier, et tout entier algébrique $\alpha\in \OK$, on a $$\alpha^{\Norm_{K/\Q}(n)} \equiv \alpha \pmod{n\OK}.$$
\end{theoreme}

\begin{remarque}
	Dans les deux réciproques que nous venons de donner, l'hypothèse sur le discriminants est que $n$ et $K$ doivent être premiers entre eux. C'est une hypothèse bien plus forte que de demander à ce que $n$ ne divise pas le discriminant de $K$ comme dans les corps quadratiques (\ref{ptf-reciproque}). Cela permet de tester beaucoup moins de corps.
\end{remarque}

Passons désormais aux simulations numérique.

\subsection{Simulation}

\subsubsection{Test de Fermat}

Revenons au théorème \ref{theoreme-3.6}, duquel nous voulons tirer un critère de primalité. Étant donné un entier de Carmichael $n$, la version \og cyclotomique \fg{} du test de Fermat serait la suivante.

\vspace{1em}
\begin{algorithm}[H]\label{test-Fermat-cyclotomique}\label{algo-1}
\caption{Test de Fermat dans les corps cyclotomiques}
\KwIn{$S_q$ (ensemble de nombres premiers $q$), $S_\alpha$ (ensemble coordonnées $\alpha$)}
\ForEach{$q \in S_q$}{
	\If{$n$ et $q$ sont premiers entre eux}{
		$K \leftarrow \Q(\zeta_q)$ \;
		\ForEach{$\alpha = x_0 + x_1\zeta + \dots + x_{p-1}\zeta^{p-1}$, $x_0, \dots, x_{p-1}\in S_\alpha$}{
			\If{$\alpha^{n^2}\not\equiv \alpha \pmod{n\OK}$}{
				\KwRet{$n$ n'est pas de Carmichael dans $\Q(\sqrt{d})$ et est composé} \\
				\textbf{arrêter le programme}
			}

		}
	}
}
\end{algorithm}
\vspace{1em}

L'auteur du présent texte a — comme pour les corps quadratiques — implémenté et testé cet algorithme. Force est de constater que cet algorithme s'est montré extrêmement lent et semble inutilisable. En posant $n=561$, $K = \Q(\zeta_5)$ et $S_\alpha = \{-1, 0, +1\}$, l'algorithme n'a toujours pas terminé après avoir tourné pendant une heure sur l'ordinateur personnel de l'auteur. Ce n'est finalement pas si étonnant. On aura \[\Norm(n\OK) = 561^4 = 99049307841\] et si l'on prend par exemple l'entier algébrique de coordonnées $(1, 1, 0, 0)$ \[\alpha =1 + \zeta,\] l'ordinateur portable de l'auteur n'a toujours pas su calculer $alpha^{\Norm(n\OK)}$ après trente minutes de calculs\footnote{Wolfram alpha n'a pas fait mieux.}. Les coordonnées ont pourtant été choisies pour être les plus petites possibles, mais le coût du calcul de $\alpha^{\Norm(n\OK)}$ est prohibitif. Plus généralement, si $n$ est un nombre dont on veut prouver la composition avec le test de Fermat cyclotomique et $q$ un nombre premier, on a \[\Norm(n\mathcal{O}_{\Q(\zeta_q)}) = n^{q-1},\] un nombre qui sort rapidement des capacités d'un ordinateur personnel standard. 
\subsubsection{Critère de Korselt}

Comme dans la section sur les corps quadratiques, nous cherchons ici — pour tout entier $n$ de la liste \ref{liste-carmichael} — un corps cyclotomique de la forme $\Q(\zeta_q)$, $q$ étant premier, dans lequel il n'est pas de Carmichael. Nous reprenons donc l'algorithme \ref{algo-Korselt}. Cet algorithme est en mesure de donner très rapidement, et pour \emph{tout} élément $n$ de la liste, plusieurs corps cyclotomiques dans lesquels $n$ n'est pas de Carmichael, prouvant sa composition. Voici les résultats pour l'entier $n = 561$.

\vspace{1em}
\VerbatimInput[label=Fichier \normalsize561\_cyclotomic.txt]{561cyclotomic.txt}

Nous avons testé $561$ dans les corps cyclotomiques $\Q(\zeta_q)$ où $q$ parcourt l'ensemble des nombres premiers compris entre $1$ et $300$. Il n'y a qu'un seul corps cyclotomique pour lequel $561$ reste de Carmchael : c'est $\Q(\zeta_3)$ ~! Dans tous les autres, il n'est pas de Carmichael. Le fichier présenté ici correspond au fichier \texttt{561\_cyclotomic.txt}, disponible à \NTS{url}. \\

Cet algorithme permet aussi de prouver que l'entier de Howe \ref{Howe} est composé ! Voici le fichier avec les résultats.

\vspace{1em}
\VerbatimInput[label=\normalsize443372888629441\_cyclotomic.txt (entier de Howe), breaklines=true]{443372888629441cyclotomic.txt}

Nous avons cette fois testé l'entier de Howe dans les corps cyclotomiques $\Q(\zeta_q)$ où $q$ parcourt l'ensemble des nombres premiers compris entre $1$ et $600$. Comme pour $561$, $Q(\zeta_3)$ est l'unique corps testé dans lequel il reste de Carmichael~!
