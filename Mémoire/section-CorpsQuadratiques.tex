\section{Corps quadratiques}

\subsection{Vers un possible test de primalité}

\subsubsection{Un résultat prometteur}

Entrons dès à présent dans le vif du sujet. L'un de nos objectifs principaux de répondre à la question \ref{question-centrale}. Le théorème 2.5 de l'article y apporte de premiers éléments de réponse.

\begin{theoreme}[2.5 dans l'article]
	Soit $n$ un entier impair sans facteurs carrés. S'il existe un diviseur premier $p$ de $n$ tel que $$p^2 - 1 \nmid n^2 - 1,$$ alors il existe une infinité de corps quadratiques $K$ dans lesquels $n$ \emph{n'est pas} de Carmichael.
\end{theoreme}

\begin{MotSurPreuve}
	On présage dès l'énoncé la nature de la preuve : c'est le critère de Korselt généralisé \ref{korselt-generalise}. On commence par s'assurer que $n$ est sans facteurs carrés de sorte de contrôler la décomposition de $n\OK$ dans un corps quadratique $K$ donné. Du reste, comme la norme d'un idéal premier au dessus de $n\OK$ est un nombre premier $p$ divisant $n$, on sent bien que la condition de non-divisibilité va empêcher être $n$ d'être de Carmichael dans les corps quadratiques\footnote{Les carrés ne sont ni plus ni moins que les normes de $p$ et de $n$ dans toute extension quadratique.} bien choisis. La partie réellement inventive de la preuve consiste à trouver les bons corps quadratiques. Cette partie est hautement non triviale et est basée sur la connaissance d'un nombre premier $p$ comme dans les hypothèses du théorème et sur une savante utilisation du théorème chinois. Les techniques de base de la ramification permettent encore une fois de s'assurer que les corps construits vérifient bien ce qu'on leur demande de vérifier. \\
\end{MotSurPreuve}

Bien que cet énoncé ne semble pas optimal en pratique\footnote{Il n'y a à ce jour (3 juin 2020) pas d'algorithme efficace pour déterminer si un entier est sans facteurs carrés. Les algorithmes passent souvent par la décomposition en produit de facteurs premiers, ce qui ne nous arrange pas. \NTS{sourcer}.}, certains nombres de Carmichael vérifient ces hypothèses. C'est le cas par exemple du nombre de $512461$ et de son facteur premier $271$. Il existe ainsi une infinité de corps quadratiques dans lequel $512461$ n'est pas de Carmichael. Mieux encore, nous avons numériquement exhibé pour chaque entier de Carmichael de la liste \ref{liste-carmichael} une liste de corps quadratiques dans lequel ledit entier n'est pas de Carmichael. \NTS{ajouter liste} \\

\begin{Complement}
	Une liste bien plus dense exhibée par l'auteur de ce mémoire est disponible sur sa page GitHub : \url{https://github.com/kryzar/ter-carmichael/blob/master/scripts/results_carmichael_not_carmichael_in_quad_field.txt}. \\
\end{Complement}

L'algorithme que nous avons utilisé pour trouver ces corps n'est en revanche probablement très sous-optimal en pratique, puisqu'il utilise le critère de Korselt généralisé et impose de décomposer l'idéal $n\OK$ en produit d'idéaux premiers\footnote{\NTS{Si possible, donner un mot sur la complexité de l'algo de décomposition dans un extension}}. Dans l'exemple 2.6 de l'article, l'auteur ouvre une voix bien plus intéressante. Il montre que $n = 561$ est composé en exhibant le corps quadratique $K = Q(\sqrt{13})$ puis l'entier algébrique $\alpha = 2 + 1\cdot \left(\frac{1 + \sqrt{13}}{2}\right) \in \OK$. Comme $$\alpha^{\Norm_{K/\Q}(n)} \not \equiv \alpha \pmod{n\OK}$$ et que $n$ et $13$ sont premiers entre eux, cela prouve la composition de $n$. Le point clé est que l'auteur ne semble pas utiliser le critère de Korselt (il n'a pas donné les détails et nous ne pouvons en conséquence pas en être sûrs). Cette approche nous invite à étudier l'algorithme \emph{probabiliste} suivant. Soit $n$ un entier impair (potentiellement de Carmichael).

\vspace{1em}
\begin{algorithm}[H]\label{algo-quadratique-faible}
\KwIn{$b$ (borne coordonnées $\alpha$)}
\ForEach{$d \in \N$ sans facteurs carrés}{
	$K \leftarrow \Q(\sqrt{d})$ \\
	$\theta\leftarrow$ un générateur de $\OK$ \\
	\If{$d$ et $n$ sont premiers entre eux}{
		\ForEach{$\alpha = x+ y\theta$, $x, y\in [\![1, b]\!]$}{
			\If{$\alpha^{n^2}\not\equiv \alpha \pmod{n\OK}$}{
				\KwRet{$n$ est composé}	\\
				\textbf{fin du programme}
			}
		}
	}
}
\end{algorithm}
\vspace{1em}

Pour que cet algorithme soit viable en pratique, il conviendra de définir la notion de \textit{témoin de Carmichael} et d'étudier finement leur répartition, à la manière du test de primalité de Rabin-Miller (voir § 2.3.7, p.69 de \cite{Demazure}). L'auteur de ce présent mémoire est pleinement conscient du travail à accomplir. Par ailleurs, il n'y aucune preuve que l'algorithme termine en l'état. \\

Il peut en outre être tentant d'utiliser cet algorithme pour déterminer la primalité de $n$ avec une certitude morale, toujours dans l'esprit test de primalité de Rabin-Miller. L'idée serait que si $n$ vérifie la congruence $\alpha^{\Norm_{\Q(\sqrt{d})/\Q}} \equiv \alpha \pmod{n\OK}$ pour un nombre suffisamment grand de corps quadratiques $K = \Q(\sqrt{d})$ de discriminant premier avec $n$ et d'entiers algébriques $\alpha \in \OK$, nous aurions une certitude morale de la primalité de $n$. Mais l'existence d'entiers \emph{composés} $h$ qui sont de Carmichael dans tout corps quadratique de discriminant premier avec $h$ est un problème majeur qui empêche de considérer cette voie. C'est le propos de la prochaine sous-section.

\subsubsection{Un piège}

Revenons un peu en arrière. Nous avons évoqué la réciproque du petit théorème de Fermat (\ref{ptf—reciproque}). Il faut bien faire attention au fait que l'énoncé suivant est faux~!

\begin{enoncefaux}[réciproque eronnée du petit théorème de Fermat généralisé]
	Soit $n>2$ un entier. Alors $n$ est premier \ssi pour tout corps \emph{quadratique} $K$ vérifiant $\pgcd(n, \Disc(K)) = 1$ et tout entier algébrique $\alpha \in \OK$, on a $$\alpha^{\Norm_{K/\Q}(n)} \equiv \alpha \pmod{n\OK}.$$
\end{enoncefaux}

Si l'on veut prouver qu'un entier $n>2$ est premier, montrer que la congruence précédente est vérifiée pour tous les corps quadratiques de discriminant premier avec $n$ ne suffit pas. Il faut s'en assurer pour tous les corps quadratiques de discriminant non divisé par $n$ — et il y en a beaucoup plus. Everett W. Howe a pu exhiber un entier $h$ qui soit à la fois composé et de Carmichael dans tout corps quadratique de discriminant premier avec $h$. Cet entier est donné par $$h = 17 \cdot 31 \cdot 41 \cdot 43 \cdot 89 \cdot 97 \cdot 167 \cdot 331.$$

Si l'on veut pouvoir trouver un test de primalité \emph{alla} Rabin-Miller comme évoqué dans la sous-section précédente, il faudra modifier l'algorithme précédent (\ref{algo-quadratique-faible}) en la version suivante.


\vspace{1em}
\begin{algorithm}[H]\label{algo-quadratique-faible}
\KwIn{$I$ (intervalle d'entiers $d$ sans facteurs carrés), $b$ (borne coordonnées $\alpha$)}
\ForEach{$d \in \N$ sans facteurs carrés dans $I$}{
	$K \leftarrow \Q(\sqrt{d})$ \\
	$\theta\leftarrow$ un générateur de $\OK$ \\
	\If{$n \nmid \Disc(K)$ sont premiers entre eux}{
		\ForEach{$\alpha = x+ y\theta$, $x, y\in [\![1, b]\!]$}{
			\If{$\alpha^{n^2}\not\equiv \alpha \pmod{n\OK}$}{
				\KwRet{$n$ est composé}	\\
				\textbf{fin du programme}
			}
		}
	}
}
\KwRet{$n$ a une certitude morale d'être premier}
\end{algorithm}
\vspace{1em}

Il y a de nouveau un travail substantiel à faire pour s'assurer de la viabilité de cette direction. Nous partons donc avant toute chose étudier le cas des corps cyclotomiques, dont l'étude s'avérera empreinte d'optimisme.

\subsection{Éléments de réponse à la question \ref{question-centrale}}

\subsubsection{D'un moyen corps vers un grand corps}

Cela montre en particulier le résultat suivant et apporte une première réponse à la question \ref{question-centrale}.

\begin{proposition}\label{premier-ce}
	Il existe des tours de corps de nombres $\Q\subset K \subset L$ et des idéaux de Carmichael $I$ de $K$ qui ne sont pas de Carmichael dans $L$.
\end{proposition}

\begin{remarque}
	Il n'aura pas fallu aller chercher bien loin pour trouver des exemples de tels corps et idéaux. Prendre $K = \Q$ et un corps quadratique pour $L$ aura suffi. Si l'on dispose d'un idéal de Carmichael dans un corps de nombres donné et d'une extension finie de ce corps de nombres, il s'avère difficile de déterminer si l'idéal reste de Carmichael dans le grand corps de nombres.
\end{remarque}

\subsubsection{D'un grand corps vers un moyen corps}

Revenons un peu en arrière et reposons nous la question centrale \ref{question-centrale}. Nous avons déjà prouvé qu'un idéal de Carmichael dans un corps de nombres donné ne l'est pas forcément dans une extension finie de ce dernier : c'est la proposition \ref{premier-ce}. Réciproquement, étant donnés une tour de corps de nombres $\Q\subset K \subset L$ et $J$ un idéal de Carmichael de $L$, l'idéal restreint $J\cap \OK$ est-il de Carmichael dans $K$ ? Là encore, ce n'est pas forcément le cas.

\begin{proposition}\label{deuxieme-ce}
	Il existe des tours de corps de nombres $\Q\subset K \subset L$ et des idéaux de Carmichael $J$ de $L$ pour lesquels l'idéal restreint $J\cap \OK$ n'est pas de Carmichael dans $K$.
\end{proposition}
