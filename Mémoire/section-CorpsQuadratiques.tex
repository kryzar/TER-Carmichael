\section{Corps quadratiques}

\subsection{Vers le test de Fermat}

Entrons dès à présent dans le vif du sujet. L'un de nos objectifs principaux de répondre à la question \ref{question-centrale}. Le théorème 2.5 de l'article y apporte de premiers éléments de réponse.

\begin{theoreme}[2.5 dans l'article]\label{theoreme-2.5}
	Soit $n$ un entier impair sans facteurs carrés. S'il existe un diviseur premier $p$ de $n$ tel que $$p^2 - 1 \nmid n^2 - 1,$$ alors il existe une infinité de corps quadratiques $K$ dans lesquels $n$ \emph{n'est pas} de Carmichael.
\end{theoreme}

\begin{MotSurPreuve}
	On présage dès l'énoncé la nature de la preuve : c'est le critère de Korselt généralisé \ref{korselt-generalise}. On commence par s'assurer que $n$ est sans facteurs carrés de sorte de contrôler la décomposition de $n\OK$ dans un corps quadratique $K$ donné. Du reste, comme la norme d'un idéal premier au dessus de $n\OK$ est un nombre premier $p$ divisant $n$, on sent bien que la condition de non-divisibilité va empêcher être $n$ d'être de Carmichael dans les corps quadratiques\footnote{Les carrés ne sont ni plus ni moins que les normes de $p$ et de $n$ dans toute extension quadratique.} bien choisis. La partie réellement inventive de la preuve consiste à trouver les bons corps quadratiques. Cette partie est hautement non triviale et est basée sur la connaissance d'un nombre premier $p$ comme dans les hypothèses du théorème et sur une savante utilisation du théorème chinois. Les techniques de base de la ramification permettent encore une fois de s'assurer que les corps construits vérifient bien ce qu'on leur demande de vérifier. \\
\end{MotSurPreuve}

Bien que cet énoncé ne semble pas optimal en pratique\footnote{Il n'y a à ce jour (3 juin 2020) pas d'algorithme efficace pour déterminer si un entier est sans facteurs carrés. Les algorithmes passent souvent par la décomposition en produit de facteurs premiers, ce qui ne nous arrange pas. \NTS{sourcer}.}, certains nombres de Carmichael vérifient ces hypothèses. On vérifie numériquement que c'est même le cas de tous les nombres de Carmichael de la liste \ref{liste-carmichael} ~! On peut par exemple prendre l'entier de Carmichael $512461$ de son facteur premier $271$ : il existe ainsi une infinité de corps quadratiques dans lequel $512461$ n'est pas de Carmichael. \\

Dans l'exemple 2.6 de l'article, l'auteur ouvre une voix intéressante : celle du test de Fermat dans les corps quadratiques. Il montre que $n = 561$ est composé en exhibant le corps quadratique $K = Q(\sqrt{13})$ puis l'entier algébrique $\alpha = 2 + 1\cdot \left(\frac{1 + \sqrt{13}}{2}\right) \in \OK$. Comme $$\alpha^{\Norm_{K/\Q}(n)} \not \equiv \alpha \pmod{n\OK}$$ et que $n$ et $13$ sont premiers entre eux, cela prouve la composition de $n$, d'après le théorème \ref{ptf}. Bien qu'il ne donne pas les détails, cela laisse penser que plutôt que d'utiliser le critère de Korselt\footnote{Ce qui nécessiterait de décomposer l'idéal $561\mathcal{O}_{\Q(\sqrt{13})}$.}, ce dernier a directement cherché un entier algébrique $\alpha$ ne vérifiant pas la congruence \ref{congruence-Carmichael}. Cet algorithme est appelé \emph{test de Fermat dans les corps quadratiques} et est un critère de composition. Étant donné un entier $n$ dont on veut prouver la composition, une version simple du test est la suivante.

\vspace{1em}
\begin{algorithm}[H]\label{test-Fermat-quadratique}\label{algo-1}
\caption{Test de Fermat dans les corps quadratiques}
\KwIn{S (ensemble coordonnées $\alpha$)}
\ForEach{$d \in \N$ sans facteurs carrés}{
	$K \leftarrow \Q(\sqrt{d})$ \\
	$\theta\leftarrow$ un générateur de $\OK$ \\
	\If{$d$ et $n$ sont premiers entre eux}{
		\ForEach{$\alpha = x+ y\theta$, $x, y\in S$}{
			\If{$\alpha^{n^2}\not\equiv \alpha \pmod{n\OK}$}{
				\KwRet{$n$ n'est pas de Carmichael dans $\Q(\sqrt{d})$ et est composé}	\\
				\textbf{fin du programme}
			}
		}
	}
}
\end{algorithm}
\vspace{1em}

L'auteur du présent texte a donc implémenté\footnote{\NTS{dire que détails dans annexe}} cet algorithme et l'a testé sur tous les entiers de la liste \ref{liste-carmichael}, en choisissant\footnote{L'entier $43$ est le premier nombre premier impair qui ne soit facteur d'aucun entier de la liste \ref{liste-carmichael}. Le discriminant de $\Q(\sqrt{43})$ sera donc premier à tout tel entier, ce qui est nécessaire pour appliquer le théorème \ref{ptf}.} le corps quadratique \[K = \Q(\sqrt{43}).\] En reprenant les notations de l'algorithme \ref{test-Fermat-quadratique}, on se fixe $$ S = [\![-3, +3]\!]$$ et $\theta = \sqrt{43}$. Nous avons pu exhiber des $K$-témoins de Fermat pour beaucoup d'entiers de la liste : pour $561$ nous trouvons $\alpha = 1 + 2\theta$, pour 2821 nous trouvons $\alpha = -3 + 2\theta$. Il y a toutefois des entiers pour lesquels nous ne trouvons aucun témoin avec ces paramètres. C'est le cas de $6601$. En changeant de corps et en prenant arbitrairement $K = \Q(\sqrt{-7})$, nous trouvons un $K$-témoin de Fermat pour $6601$ mais pas pour $2465$. Utiliser le test de Fermat—quadratique nécessiterait donc plus de finesse que cette version naïve de l'algorithme. \NTS{rajouter temps de calcul} \\

Il peut enfin être tentant d'utiliser cet algorithme pour déterminer la primalité de $n$ \emph{avec une certitude morale}, dans l'esprit test de primalité de Rabin-Miller (voir \cite{Demazure}, §3.3.7, p. 68). L'idée serait que si $n$ vérifie la congruence $\alpha^{\Norm_{\Q(\sqrt{d})/\Q}} \equiv \alpha \pmod{n\OK}$ pour un nombre suffisamment grand de corps quadratiques $K = \Q(\sqrt{d})$ de discriminant premier avec $n$ et d'entiers algébriques $\alpha \in \OK$, nous aurions une certitude morale de la primalité de $n$. Nous allons voir dans la prochaine sous-section qu'un tel test ne peut exister.

\subsection{Un pas en arrière}

Nous avons évoqué la réciproque du petit théorème de Fermat (\ref{ptf-reciproque}). Il faut bien faire attention au fait que l'on ne peut pas remplacer l'hypothèse \og $n \nmid \Disc(K)$\fg par l'hypothèse \og $n$ et $\Disc(K)$ sont premiers entre eux \fg \footnote{Cela peut être contre intuitif : si $n$ est un entier et $K$ un corps de nombres, le fait que $n$ soit de Carmichael dans $K$ implique que $n$ et $\Disc(K)$ soient premiers entre eux.}~! Le mathématicien E.W. Howe montre en effet le résultat suivant.

\begin{theoreme}[Howe, 200]
	Il existe un entier $h$ qui soit à la fois \emph{composé} et de Carmichael dans tout corps quadratique de discriminant premier avec $h$.
\end{theoreme}

En guise de preuve, Howe exhibe un tel nombre, l'entier 
	\begin{equation}\label{Howe}
		h = 17 \cdot 31 \cdot 41 \cdot 43 \cdot 89 \cdot 97 \cdot 167 \cdot 331 = 443372888629441.
	\end{equation}

Nous l'appellerons dans la suite \emph{entier de Howe}. L'existence de cet entier signifie que — comme dans $\Q$ — le test de Fermat \ref{test-Fermat-quadratiqeu} ne peut pas prouver qu'un entier est composé simplement parce qu'il n'a pas de témoins de Fermat. Plus généralement, l'auteur de l'article montre le théorème suivant.

\begin{theoreme}[2.7 dans l'article]\label{theoreme-2.7}
	Soient $n$ un entier composé sans facteur carré et $d\geq 1$ un entier. Si pour tout diviseur $p$ de $n$ et tout enter $1\leq i \leq d$ la division $$p^i - 1\mid n^d - 1$$ est vérifiée, alors $n$ est de Carmichael dans $\Q$ et tout corps de nombres de degré $d$ de discriminant premier avec $n$.
\end{theoreme}

\begin{definition}
	Un entier $n$ vérifiant les hypothèses du théorème \ref{theoreme-2.7} pour un certain entier $d\geq 1$ est appelé \emph{nombre de Carmichael rigide d'ordre $d$}.
\end{definition}

L'entier de Howe \ref{Howe} est donc un nombre de Carmichael rigide d'ordre $2$. Ces troublants résultats nous enseignent que les corps quadratiques ne peuvent pas fournir un test de Fermat fiable. Forts de ce constant, nous partons étudier les corps cyclotomiques, dont l'étude s'avérera porteuse d'espoir.
