\section{Corps quadratiques}

\subsection{Théorie}

Entrons dès à présent dans le vif du sujet. 

\begin{theoreme}[{\cite[th. 2.5]{article}}]\label{theoreme-2.5}
	Soit $n$ un entier rationnel impair sans facteurs carrés. S'il existe un diviseur premier $p$ de $n$ vérifiant $$p^2 - 1 \nmid n^2 - 1,$$ alors il existe une infinité de corps quadratiques $K$ dans lesquels $n$ \emph{n'est pas} de Carmichael.
\end{theoreme}

\begin{MotSurPreuve}
	On présage dès l'énoncé la nature de la preuve : c'est le critère de Korselt généralisé \ref{korselt-generalise} et la caractérisation \ref{carac-korselt}. On commence par s'assurer que $n$ est sans facteurs carrés de sorte de contrôler la décomposition de $n\OK$ dans un corps quadratique $K$ donné. La partie la plus difficile de la preuve consiste à trouver les bons corps quadratiques. Elle est basée sur la connaissance d'un nombre premier $p$ comme dans les hypothèses du théorème et sur une savante utilisation du théorème chinois. Les techniques de base de la ramification permettent encore une fois de s'assurer que les corps construits vérifient bien ce qu'on leur demande de vérifier. \\
\end{MotSurPreuve}

Bien que cet énoncé ne semble pas optimal en pratique\footnote{Il n'y a à ce jour (3 juin 2020) pas d'algorithme efficace pour déterminer si un entier rationnel est sans facteurs carrés. Les algorithmes passent souvent par la décomposition en produit de facteurs premiers (voir \cite{SquareFree}), ce qui ne nous arrange pas.}, certains nombres de Carmichael vérifient ces hypothèses : c'est même le cas de tous les nombres de Carmichael de la liste \ref{liste-carmichael}. Il existe donc pour chacun d'eux une infinité de corps quadratiques dans lesquels ils ne sont pas de Carmichael, prouvant qu'ils sont composés (énoncé \ref{ptf-equivalence}). Dans l'exemple 2.6, l'auteur trouve le $\Q(\sqrt{13})$-témoin de Fermat $2 + 1\cdot \left(\frac{1 + \sqrt{13}}{2}\right)$ pour $n=561$, prouvant sa composition. C'est le \emph{test de Fermat dans les corps quadratiques}. Étant donné un entier rationnel $n$ on se donne une liste de corps quadratiques $K$ de discriminant premier avec $n$ et l'on cherche dans chacun d'eux un $K$-témoin de Fermat. \\


Il par ailleurs tentant d'utiliser ce test pour déterminer la primalité de $n$ \emph{avec une certitude morale}, dans l'esprit du  test de primalité de Rabin-Miller (voir \cite[§ 3.3.7 p. 68]{Demazure}). L'idée serait que si $n$ vérifie la congruence $\alpha^{\Norm(n\OK)} \equiv \alpha \pmod{n\OK}$ pour un nombre \og suffisamment grand \fg{} de corps quadratiques $K = \Q(\sqrt{d})$ de discriminant premier avec $n$ et d'entiers $\alpha \in \OK$, nous aurions une certitude morale de la primalité de $n$. Nous allons cependant voir qu'un tel test ne saurait exister. Nous avons évoqué la réciproque du petit théorème de Fermat (\ref{ptf-equivalence}). Il faut bien faire attention au fait que l'on ne peut pas remplacer l'hypothèse \og $n \nmid \Disc(K)$\fg par l'hypothèse \og $n$ et $\Disc(K)$ sont premiers entre eux \fg \footnote{Cela peut être contre intuitif : si $n$ est un entier rationnel et $K$ un corps de nombres, le fait que $n$ soit de Carmichael dans $K$ implique que $n$ et $\Disc(K)$ sont premiers entre eux.}~! Le mathématicien E.W. Howe montre en effet le résultat suivant.

\begin{theoreme}[Howe, 2000]
	Il existe un entier rationnel $h$ qui soit à la fois \emph{composé} et de Carmichael dans tout corps quadratique de discriminant premier avec $h$.
\end{theoreme}

En guise de preuve, Howe exhibe un tel nombre, défini par
	\begin{equation}\label{Howe}
		h = 17 \cdot 31 \cdot 41 \cdot 43 \cdot 89 \cdot 97 \cdot 167 \cdot 331 = 443372888629441.
	\end{equation}

Nous l'appellerons dans la suite \emph{entier de Howe}. Il est même de Carmichael dans $\Q$. L'existence de cet entier rationnel signifie que — comme dans $\Q$ — le test de Fermat quadratique ne peut pas prouver qu'un entier rationnel est composé simplement parce qu'il n'a de $K$-témoins de Fermat dans aucun corps quadratique $K$ dont le discriminant lui est premier. Plus généralement, l'auteur de l'article montre le théorème suivant.

\begin{theoreme}[{\cite[th. 2.7]{article}}]\label{theoreme-2.7}
	Soient $n$ un entier rationnel composé sans facteurs carrés et $d\geq 1$ un entier rationnel. Si pour tout diviseur $p$ de $n$ et tout enter $1\leq i \leq d$ la division $$p^i - 1\mid n^d - 1$$ est vérifiée, alors $n$ est de Carmichael dans tout corps de nombres de degré $d$ de discriminant premier avec $n$.
\end{theoreme}

\begin{definition}
	Un entier rationnel $n$ vérifiant les hypothèses du théorème \ref{theoreme-2.7} pour un certain entier rationnel $d\geq 1$ est appelé \emph{nombre de Carmichael rigide d'ordre $d$}.
\end{definition}

L'entier de Howe est donc un nombre de Carmichael rigide d'ordre $2$. Ces résultats nous enseignent que les corps quadratiques — à l'instar de $\Q$ — ne peuvent pas détecter tous les entiers de Carmichael à l'aide avec le test de Fermat. Terminons avec un énoncé proche de l'arithmétique classique.

\begin{corollaire}
	Soit $n$ un entier rationnel. Si $n$ est sans facteurs carrés et composé, alors les propositions suivantes sont équivalentes :
	\begin{itemize}
		\item l'entier $n$ est de Carmichael dans tout corps quadratique de discriminant premier avec $n$~;
		\item la relation \[p^2 - 1 \mid n^2 - 1\] est vérifiée pour tout diviseur premier $p$ de $n$.
	\end{itemize}
\end{corollaire}

\begin{proof}
	Si $n$ est de Carmichael dans tout corps quadratique de discriminant premier avec $n$, le théorème \ref{theoreme-2.5} assure que la relation \[p^2 - 1 \mid n^2 - 1\] est vérifiée pour tout diviseur premier $p$ de $n$. Pour le sens réciproque, soit $p$ un facteur premier de $n$. On a $p-1\mid (p-1)(p+1) = p^2 - 1$ et $p^2 - 1 \mid n^2 - 1$ par hypothèse. La division \[p^i - 1 \mid n^2 - 1\] est donc vérifiée pour toute puissance $1\leq i \leq 2$. Le théorème \ref{theoreme-2.7} permet alors de conclure.
\end{proof}

\begin{remarque}
	L'énoncé est faux si $n$ n'est pas composé. Sous cette hypothèse, notons $p=n$. Soit $K$ un corps quadratique dans lequel $p$ est inerte. Un idéal de Carmichael étant composé, $p$ n'est pas de Carmichael dans $K$. L'identité $p^2 - 1 | n^2 - 1 = p^2 - 1$ est cependant vérifiée.
\end{remarque}

Passons désormais aux simulations numériques.

\subsection{Simulations numériques}

Nous étudions ici le critère de composition de Korselt \label{test-primalite-korselt} dans des corps quadratiques\footnote{Pour l'implémentation, voir la fonction \texttt{Carmichael\_quadratic} du fichier \url{https://github.com/kryzar/TER-Carmichael/blob/master/Simulations\%20et\%20resultats/Algorithms.sage}.}. Pour tout entier rationnel $n$, nous cherchons une liste de corps quadratiques dans lesquels $n$ n'est pas de Carmichael. Pour cela, nous lançons l'algorithme avec les paramètres suivants.

\begin{table}[H]\label{param-korselt-quadra}
	\begin{center}
		\begin{tabularx}{\textwidth}{|Y|Y|}
			\hline
			paramètre & valeur \\
			\hline
			\hline
			corps testés & corps quadratiques de la forme $\Q(\sqrt{d})$ où $d$ est un entier rationnel sans facteurs carrés dans $[\![-5000, +5000]\!]$\footnote{Il y a 6084 tels entiers.} \\\hline
			entiers de Carmichael testés & tous ceux de la liste \ref{liste-carmichael}  \\\hline
		\end{tabularx}
		\caption{Paramètres des simulations du critère de Korselt pour les corps quadratiques.}
	\end{center}
\end{table}

Avec ces paramètres, le critère de Korselt a donné pour chaque élément $n$ de la liste, plusieurs corps quadratiques de discriminant premier avec $n$ dans lesquels $n$ n'est pas de Carmichael. En fait, il en exhibe des centaines. Il est donc impossible d'énoncer ici tous les résultats\footnote{Les résultats se trouvent tous dans \url{https://github.com/kryzar/TER-Carmichael/tree/master/Simulations\%20et\%20resultats}, sous la forme d'un fichier par entier testé. Par exemple, les résultats pour l'entier $561$ se trouvent dans le fichier \texttt{561\_quadratic.txt}.}, mais citons à titre d'exemple que $561$ n'est pas de Carmichael dans $\Q(\sqrt{-4874})$ mais qu'il l'est dans $\Q(\sqrt{4877})$ ou que $172081$ n'est pas de Carmichael dans $\Q(\sqrt{766})$ mais qu'il l'est dans $\Q(\sqrt{-1459})$.  Pour la plupart des couples $(n, K)$ testés, $n$ n'est pas de Carmichael dans $K$. Nous avons tiré les statistiques suivantes de nos simulations.

\begin{table}[H]\label{statistiques-quadra}
	\begin{center}
		\begin{tabular}{|c|c|}
			\hline
			donnée évaluée & statistique \\
			\hline
			\hline
			nombre de corps testés & 143524 \\\hline
			nombre d'idéaux de Carmichael trouvés dans ces corps & 34138 \\\hline
			proportion d'idéaux de Carmichael trouvés dans ces corps & 23,8 \% \\\hline
		\end{tabular}
		\caption{Statistiques des simulations du critère de Korselt sur les corps quadratiques.}
	\end{center}
\end{table}

S'il s'avère que l'entier rationnel $n$ que nous testons n'est pas comme l'entier de Howe et admet bien un $K$-témoin de Fermat dans un certains corps quadratique $K$ dont le discriminant lui est premier, ces résultats laissent penser qu'on a de bonnes chances de le trouver. Bien sûr, ces sommaires statistiques ne prouvent rien et on ne sait pas déterminer a priori s'il existe ou non un tel témoin. Pour les performances, les calculs sont extrêmement rapides dans tous les corps. Nous donnons ici le temps nécessaire au critère de Korselt pour déterminer si l'entier $n = 512461$ est de Carmichael dans les corps donnés. D'après nos tests, ils sont sensiblement proches pour tout entier rationnel et tout corps quadratique testé.

\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|c|}
			\hline
			corps quadratiques & $512461$ reste de Carmichael dans ce corps & temps de calcul \\
			\hline
			\hline
			$\Q(\sqrt{-4957})$ & non & 0.00303 s \\\hline
			$\Q(\sqrt{-2426})$ & oui &0.00211 s \\\hline
			$\Q(\sqrt{-2})$ & non & 0.0024 s \\\hline
			$\Q(\sqrt{+2})$ & non & 0.0024 s \\\hline
			$\Q(\sqrt{+2426})$ & oui & 0.0031 s \\\hline
			$\Q(\sqrt{+4957})$ & oui & 0.0031 s \\\hline
		\end{tabular}
		\caption{Temps de calcul du critère Korselt dans les corps quadratiques donnés pour l'entier $n=512461$.}
	\end{center}
\end{table}
