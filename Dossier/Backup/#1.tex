% main.tex
% Antoine Hugounet

\documentclass[a4paper, 12pt, oneside]{article}
\usepackage{LoLaTeXpackage}
\usepackage{csquotes}
\usepackage{biblatex}
\usepackage[tworuled, onelanguage, french]{algorithm2e}


\addbibresource{bi.bib}
\begin{document}

% début page de titre
\begin{titlepage}
\begin{center}
	\large Antoine Hugounet \\

	\vspace{40px}
	\LARGE \textbf{Petits résultats sur les idéaux de Carmichael}

	\vspace{40px}
	\large
	travail encadré de recherche \\
	encadré par Alain Kraus (IMJ-PRG) \\
	soutenu le \NTS{date} \\

	\vspace{20px}
	Sorbonne Université
\end{center}

\normalsize
\vspace{80px}
\begin{center} \textbf{Trop Long ; Pas Lu} \end{center}
\vspace{-1em}
\NTS{placeholder}

\vfill
\begin{center}
	\normalsize \textbf{Mots-clés} : \textit{\NTS{placeholder}}
\end{center}
\end{titlepage}
%% fin page de titre

\section{Question 2}

Soit $n\in \Z$ un entier. Peut on trouver une tour de corps de nombres $\Q \subset K \subset L$ telle que $n$ engendre un idéal de Carmichael dans $\OL$ et non dans $\OK$ ? Ce problème revient à se demander si le fait que $n\OL$ vérifie le critère de Korselt implique que $n\OK$ le vérifie. Nous affirmons que cette assertion est fausse en exhibant un contre exemple.

\subsection{Étude des facteurs carrés}

Commençons par ce résultat simple.

\begin{fait}Soient $A$ un anneau commutatif, $B$ une $A$-algèbre commutative et $I$, $J$ deux idéaux de $A$. Alors $$(IJ) B = (IB)(JB).$$
\end{fait}

\begin{proof}
	Par double inclusion. L'inclusion $$(IJ)B \subset (IB)(JB)$$ est triviale, car $(IB)(JB)$ est un idéal contenant $IB$. Réciproquement, $(IB)(JB)$ est l'idéal de $B$ engendré par les produits $\alpha\beta$, où $\alpha \in IB$ et $\beta\in JB$. Montrons qu'un tel générateur $\alpha\beta$ est forcément dans $(IJ)B$. Nous savons que $\alpha$ et $\beta$ sont de la forme suivante :
	$$\begin{cases}
		\displaystyle \alpha = \sum_{i=1}^n x_i a_i, \quad x_i\in B, a_i \in I \\
		\displaystyle\beta = \sum_{j=1}^m y_j b_j, \quad y_j\in B, b_j \in J.
	\end{cases}$$
	Quitte à rajouter des termes nuls dans l'une des deux sommes, nous pouvons supposer $m=n$. Cela permet d'écrire le produit $$\alpha\beta = \sum_{i,j=1}^n (x_iy_j) (a_i b_j).$$ Pour tout couple $(i, j) \in [\![ 1, n]\!] ^2$, $x_iy_j \in B$, $a_i b_j\in IJ$, d'où $$(x_i y_j)(a_i b_j) \in (IB)J.$$ La somme de ces éléments reste dans $(IB)J$ et donc $\alpha \beta \in (IJ)B$, d'où l'inclusion $$(IB)(JB) \subset (IJ)B,$$ et le résultat désiré.
\end{proof}

Nous en déduisons le très utile résultat suivant.

\begin{fait}Soient $A$ un anneau de Dedekind, $B$ une $A$-algèbre qui soit elle aussi un anneau de Dedekind, $I$ un idéal de $A$ et $n\in \N^*$ un entier. Si $IB$ n'est pas divisé par un idéal premier à la puissance $n$, alors $I$ non plus.
\end{fait}

\begin{proof}
Supposons par l'absurde que $\p$ est un idéal premier de $A$ et que $\p^n$ divise $I$, autrement dit que I d'écrit $$I = \p^n J$$ pour un certain idéal $J$ de $A$. D'après le résultat précédent, on peut écrire $$IB = (\p B)^n J.$$ Soit $\P$ un idéal premier de $B$ au dessus de $\p$. On constate alors que $\P^n$ divise $IB$, contradiction. Il n'existe donc aucun idéal premier $\p$ de $A$ tel que $\p^n$ divise $I$.
\end{proof}

\begin{corollaire}Soient $n\in \Z$ un entier et $\Q\subset K\subset L$ une tour de corps de nombres. Si $n\OL$ est sans facteurs carrés, alors $n\OK$ l'est également.
\end{corollaire}

\begin{proof}Il suffit d'appliquer le fait précédent avec $A=\OK$, $B=\OL$ et $I = n\OK$.
\end{proof}

Reprenons les notations du préambule et supposons que $n\OL$ soit de Carmichael. Il vérifie alors le critère de Korselt et est sans facteurs carrés. Le corollaire précédent montre que $n\OK$ l'est aussi : il vérifie donc cette condition du critère de Korselt. Il faut donc étudier la norme de $n\OK$ et ses propriétés par rapport à celle de $n\OL$ pour répondre à notre question.

\subsection{Étude de la norme}

Puisque la norme des éléments se comporte très bien avec les sous-extensions\footnote{Si l'on se donne $x$ un élément de $\OK$, alors $\Norm_{\OL}(x) = \Norm_{\OK}(x)^{[L : K]}$.}, il est raisonnable de penser que cela sera aussi le cas des normes d'idéaux. Nous avons alors ce premier résultat.

\begin{fait}\label{fait1} 
	Soient $\Q\subset K \subset L$ une tour de corps de nombres et $I$ un idéal non trivial de $\OL$. Si l'idéal restreint $I\cap \OK$ est non trivial, alors $$\Norm_{\OK}(I \cap \OK) \mid \Norm_{\OL}(I).$$
\end{fait}

\begin{proof}
C'est un résultat de théorie des groupes à peine déguisé. On a une suite de morphismes de groupes $$\OK\to \OL \to \OL/I.$$ En appelant $f$ la composée des deux flèches, on obtient $\Ker f = I\cap \OK$ et l'on en déduit l'existence d'un morphisme de groupes injectif $$\OK/I\cap \OK \hookrightarrow \OL/I.$$ Ainsi, $\OK/ I\cap \OK$ s'identifie à un sous-groupe de $\OL/I$. D'après le théorème de Lagrange, son cardinal divise donc celui de $\OL/I$. Or, comme nos idéaux sont non triviaux, nous pouvons en prendre les normes, qui sont exactement les cardinaux de ces quotients, par définition. D'où le résultat.
\end{proof}

\NTS{Blabla pas optimal}

\begin{exemple}
	Prenons $\Q \subset K \subset L$, avec $ K =\Q(\sqrt{2})$, $L = \Q(\sqrt{2}, \sqrt{3})$ puis posons enfin $I$ l'idéal de $\OL$ engendré par $\sqrt{3}$. Ce dernier étant principal, sa norme est celle de son générateur, et $\Norm_{L/\Q}(\sqrt{3})$ est par définition le déterminant de l'application $\Q$-linéaire de multiplication par $\sqrt{3}$ : \begin{align*} L &\to L \\ x &\mapsto \sqrt{3} x.\end{align*} Dans la base canonique $(1, \sqrt{2}, \sqrt{3}, \sqrt{2}\sqrt{3})$, cette application a pour matrice la matrice $$\begin{pmatrix} 0 & 0 & 3 & 0 \\ 0 & 0 & 0 & 3 \\ 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0\end{pmatrix},$$ dont le déterminant est $9$. Ainsi, $\Norm_{L/\Q}(\sqrt{3}) = 9$. \NTS{calculer l'autre norme}

Finalement, nous obtenons $\Norm_{\OL}(I) = 9$, $\Norm_{\OK}(I\cap \OK)=1$... et rien de plus. Cet exemple montre en particulier que la norme dans le grand corps de nombre ne s'obtient pas en général comme une puissance de la norme dans le petit corps de nombres, et ce même quand l'idéal considéré est principal. C'est ce constat qui nous a amené à l'hypothèse qu'un idéal de Carmichael dans un grand corps de nombres ne l'est pas nécessairement dans un petit corps de nombres.
\end{exemple}

\subsection{Synthèse et contre-exemple}

Intuitivement, la condition imposée sur les normes par le critère de Korselt semble trop forte pour être transmise du grand anneau d'entiers au moyen anneau d'entiers. Reprenons les notations du premier paragraphe, supposons que $n\OL$ est de Carmichael, et admettons que $n\OK$ demeure sans facteur carré. Soit $\p$ un idéal premier de $\OK$ divisant $n\OK$. Alors $p=\P\cap \OK$, où $\P$ est un idéal premier de $\OL$ divisant $n\OL$. On sait d'après le fait \ref{fait1} que $$\Norm_K(\p) \mid \Norm_L(\P),$$ et même en cherchant longtemps, cette condition ne permet en aucun cas de conclure que $\Norm_K(\p) - 1\mid \Norm_K(n\OK) - 1$ en ayant pour seule hypothèse (critère de Korselt) que $\Norm_L(\P) - 1 \mid \Norm_L(n\OL) - 1$. \\

Après avoir cherché sans succès un contre-exemple \og{} malin \fg, nous décidons d'écrire un algorithme naïf pour chercher ledit contre-exemple. L'idée est simple : se restreindre aux corps quadratiques, passer en revue une liste d'entiers $d$ sans facteur carré qui engendrent ces corps, et pour chaque tel $d$, tester parmi un nombre arbitraire d'entiers naturels $n$, lesquels engendrent un idéal de Carmichael dans $\Q(\sqrt{d})$ sans être un nombre de Carmichael. Voici l'algorithme en pseudo code. \\

\begin{algorithm}[H]
\KwIn{a, b, c}
\ForEach{$d\in [\![a, b]\!]$ et $d$ est sans facteur carré}{
	$K = \Q(\sqrt{d})$ \; 
	\ForEach{$n \in [\![2, c]\!]$}{
		\If{$n$ n'est pas de Carmichael et $n\OK$ est un idéal de Carmichael}{
			exporter $(d, n)$ dans un fichier texte	\;
		}
	}
}
\end{algorithm}

\vspace{1em}
La version implémentée dans Sage de cet algorithme est disponible sur GitHub (\NTS{lien}). Nous avons pu exhiber de nombreux contre-exemples, comme le couple $$(d, n) = (11, 35).$$ L'entier $35$ n'est pas de Carmichael, mais il engendre un idéal de Carmichael dans $\Q(\sqrt{11})$. Le couple $$(d, n) = (95,8029)$$ est un autre contre-exemple, avec la particularité que $8029$ soit le produit de trois nombres premiers distincts ($7$, $31$ et $37$). De même, $8029$ n'est pas un entier de Carmichael, mais il engendre un idéal de Carmichael dans $\Q(\sqrt{95})$.

\section{Addenda}

\begin{fait}
Soient $n$ un entier qui soit une puissance non triviale d'un nombre premier et $ K$ un corps de nombres. Alors $n\OK$ n'est pas un idéal premier.
\end{fait}

\begin{proof}
Écrivons $n = p^r, r>1$ et supposons que $n\OK$ soit un idéal premier $\p$ de $\OK$. Alors $\Norm_K(n\OK)$ est une puissance de la caractéristique $\Car(\OK/\p)$, disons $$\Norm_K(n\OK) = \Car(\OK/\p)^f,$$ où $f \leq [K : \Q]$. Mais on a aussi que $$\Norm_K(n\OK) = \Norm_K(n) = (p^r)^{[K : \Q]}.$$ La caractéristique $\Car(\OK/\p)$ étant un nombre premier, il vient $p^f = p^{r[K : \Q]}$. Comme par ailleurs $$f \leq [K : \Q] < r[K : \Q],$$ l'égalité est impossible, et nous avons une contradiction. $n\OK$ n'est donc pas un idéal premier.
\end{proof}

\begin{fait} Soient $K$ un corps de nombres et $\P$ un idéal premier de son anneau d'entiers. Alors $$\P\cap \Z = \Car(\OK/\P)\Z.$$
\end{fait}

\begin{proof}
	D'après \ref{fait1}, $\Norm_{\Q/\Q}(\P\cap\Z)\mid \Norm_{K/\Q}(\P)$. Or, $\N_{K/\Q}(\P)$ est la puissance d'un nombre premier, et ce nombre premier n'est autre que la caractéristique du \textit{corps} $\OK/\P$. Or $\P\cap \Z$ est un idéal premier de $\Z$, et $\Z$ étant principal, $\P\cap \Z$ est engendré par un nombre premier $p\in \Z$. Ainsi, $$\Norm_{\Q/\Q}(\P\cap \Z) = |\Z/p\Z| = p,$$ et donc $$p\mid \Car(O_K/\P).$$ Comme ces deux nombres sont premiers, on a $p = \Car(O_K/\P)$.
\end{proof}


\newpage
\nocite{*}
\printbibliography
\end{document}
